var pages={UserAnalytics:require("pages/userAnalytics/userAnalytics"),RetentionAddiction:require("pages/retentionAddiction/retentionAddiction")};sensorsdata.BookmarkSave=function(a){if($.isEmptyObject(a))throw"options is empty when call New BookmarkSave(options)";this.defaultBookmark_={related_events:[]},this.defaultOptions_={disabled:sensorsdata.authority.isNormal,saveBarDisplay:!0,dialogTitleDisplay:!1,samplingDisplay:!0,refreshDisplay:!0,downloadDisplay:!0,container:$("#sa-main"),placement:"before",dialogAttachElement:null,dialogContainer:"body",dialogViewport:"",bookmarkId:"",showSessionDropdown:!1,sessionDropdownValue:"event",onSampleChanged:null,onRefreshClick:null,onDownloadClick:null,onBookmarkAdded:null,onBookmarkUpdated:null,onBookmarkDeleted:null,onSessionChanged:null,onBookmarkNameChanged:null,algDropdownDisplay:!1,onAlgChanged:null,dashboardDisplay:!0},this.options_=$.extend(!0,this.defaultOptions_,a),this.options_.samplingFactor=$.isNumeric(this.options_.samplingFactor)?parseInt(this.options_.samplingFactor,10):64,this.saveBar_=$($("#tpl-bookmark-save-bar").html()),this.btnRefresh_=this.saveBar_.find('button[data-method="refresh"]'),this.options_.saveBarDisplay===!0&&this.options_.container.prepend(this.saveBar_),this.tplDialog_=$("#tpl-bookmark-save-dialog").html(),this.dialog_=null,this.saveBarStyle_={add:{className:"glyphicon glyphicon-star-empty",text:sensorsdata.languages.get("保存为书签<!--{en}Save as bookmark-->")},update:{className:"glyphicon glyphicon-star",text:sensorsdata.languages.get("已保存<!--{en}Already saved-->")}},this.newBookmark_=$.extend(!0,{},this.defaultBookmark_),this.bookmark_={},this.options_.bookmarkId&&(this.bookmark_.id=this.options_.bookmarkId),this.dashboards_=[],this.samplingSlider_=null,this.init_()},sensorsdata.BookmarkSave.prototype.setRefresh=function(a){sensorsdata.BookmarkSave.setRefreshButton(this.saveBar_.find('button[data-method="refresh"]'),a)},sensorsdata.BookmarkSave.prototype.show=function(){var a=this.options_.dialogAttachElement;this.getDialogId()||this.getDashboards_(sensorsdata.bind(function(t){this.dashboards_=t,this.renderDashboards_(t,this.bookmark_.dashboards),a.popover("show")},this))},sensorsdata.BookmarkSave.prototype.close=function(a){var t=this.options_.dialogAttachElement;$.isFunction(a)&&t.bind("hidden.bs.popover",function(){a(),t.unbind("hidden.bs.popover")}),t.popover("hide")},sensorsdata.BookmarkSave.prototype.getDialogId=function(){return this.options_.dialogAttachElement.attr("aria-describedby")},sensorsdata.BookmarkSave.prototype.setName=function(a){a=a||"",this.dialog_.find("#bookmark-name").val(a),this.defaultBookmark_.name=a,this.bookmark_.id||(this.bookmark_.name=a),this.newBookmark_&&(this.newBookmark_.name=a)},sensorsdata.BookmarkSave.prototype.clear=function(){this.bookmark_=$.extend(!0,{},this.defaultBookmark_),this.newBookmark_=$.extend(!0,{},this.defaultBookmark_),this.setSaveBar_(this.newBookmark_),this.dialog_.find("#bookmark-save-dialog-title").hide(),this.options_.dialogTitleDisplay=!1},sensorsdata.BookmarkSave.prototype.initAlgDropDown_=function(a){var t=this;t.saveBar_.find("#alg-dropdown").toggleClass("disabled",sensorsdata.authority.isNormal),t.saveBar_.find("#alg-dropdown button").toggleClass("disabled",sensorsdata.authority.isNormal);var o=t.saveBar_.find('#alg-dropdown span[data-toggle="tooltip"]');"approximate"===a.algDropdownValue&&o.show().tooltip("destroy").tooltip({placement:"bottom",container:"body"}),t.saveBar_.find("#alg-dropdown button").saDropdown({value:a.algDropdownValue,onSelected:function(t){a.onAlgChanged(t),"approximate"===t?o.show().tooltip("destroy").tooltip({placement:"bottom",container:"body"}):o.hide().tooltip("destroy")}})},sensorsdata.BookmarkSave.prototype.init_=function(){var a=this.options_;if(a.saveBarDisplay===!0){if(a.container instanceof jQuery!=!0)throw"saveBarDisplay is true, you must set container, and container must be a jQuery object.";this.saveBar_.find('[data-toggle="tooltip"]').tooltip()}else if(a.dialogAttachElement instanceof jQuery!=!0)throw"saveBarDisplay is false, you must set dialogAttachElement, and dialogAttachElement must be a jQuery object.";a.dialogAttachElement||(a.dialogAttachElement=this.saveBar_.find('[data-method="open-dialog"]'),a.dialogViewport="#sa-main"),this.dialog_=this.initDialog_(a.dialogAttachElement,a.dialogViewport),a.showSessionDropdown&&this.initSessionDropDown_(a),a.algDropdownDisplay&&this.initAlgDropDown_(a),this.saveBar_.bind("click",sensorsdata.bind(this.saveBarClick_,this)),this.dialog_.bind("click",sensorsdata.bind(this.dialogClick_,this)),this.saveBar_.is(":visible")&&(a.container.find("#sampling").toggle(a.samplingDisplay).next().toggle(a.samplingDisplay),a.samplingDisplay&&this.initSampleSlider_(),a.container.find('[data-method="refresh"]').toggle(a.refreshDisplay).prev().toggle(a.refreshDisplay),a.container.find('[data-method="download"]').toggle(a.downloadDisplay).prev().toggle(a.downloadDisplay),a.container.find("#alg-dropdown").toggle(a.algDropdownDisplay).prev().toggle(a.algDropdownDisplay)),this.bookmark_.id?(this.dialog_.find('[data-method="delete"]').show(),sensorsdata.ajax({url:"bookmarks/bookmark/"+this.bookmark_.id,success:sensorsdata.bind(function(a){$.isEmptyObject(a)?sensorsdata.error.show(sensorsdata.languages.get("此书签不存在<!--{en}This bookmark does not exist-->")):(this.bookmark_=a,this.renderInput_(this.bookmark_,this.dashboards_),this.setSaveBar_(this.bookmark_),a.user_id!==sensorsdata.authority.userId&&this.dialog_.find("#bookmark-save-dialog-title").find('a[data-method="switch-add"]').addClass("active").siblings().removeClass("active"))},this)})):(this.dialog_.find('[data-method="delete"]').hide(),this.renderInput_(this.bookmark_,this.dashboards_),this.setSaveBar_(this.bookmark_))},sensorsdata.BookmarkSave.prototype.initSessionDropDown_=function(a){var t=this;t.saveBar_.find("#session-dropdown").toggleClass("disabled",sensorsdata.authority.isNormal).show().prev().show(),t.saveBar_.find("#session-dropdown button").toggleClass("disabled",sensorsdata.authority.isNormal),sensorsdata.ajax({useCache:!0,url:"sessions/all",success:function(o){$.isArray(o)||(o=[]),t.saveBar_.find("#session-dropdown button").saDropdown({value:a.sessionDropdownValue,onSelect:function(){return 0===o.length&&sensorsdata.info.show(sensorsdata.languages.get('请先在“元数据”中创建 Session<!--{en}Please create Session in "metadata"-->')),o.length>0},onSelected:function(o){a.onSessionChanged(o),$.isFunction(t.options_.onBookmarkNameChanged)&&t.options_.onBookmarkNameChanged()}})}})},sensorsdata.BookmarkSave.prototype.initSampleSlider_=function(){var a=this,t=this.options_,o=sensorsdata.BookmarkSave.dealSamplingValue(t.samplingFactor);o=Math.log(o)/Math.log(2);var s="#sampling-factor-slider",e=this.saveBar_.find(s),i=this.saveBar_.find("#sampling-factor-label"),n=function(a){return 64===a?sensorsdata.languages.get("全量<!--{en}Total-->"):"1/"+64/a};i.text(n(t.samplingFactor)),e.val(o),this.samplingSlider_=new Slider(s,{value:o,tooltip_position:"bottom",formatter:function(t){return 6===t?sensorsdata.languages.get("对全量数据计算<!--{en}Total data calculation-->"):(t=a.getSamplingValue(t),sensorsdata.util.format(sensorsdata.languages.get("对全量数据抽样1/#{value}计算<!--{en}1/#{value} random sample of total data calculation-->"),{value:64/t}))}}),sensorsdata.authority.isNormal&&this.samplingSlider_.disable(),e.on("change",function(){var o=a.getSamplingValue();i.text(n(o)),$.isFunction(a.options_.onSampleChanged)&&t.onSampleChanged(o),sensorsdata.track("sampling")})},sensorsdata.BookmarkSave.prototype.initDialog_=function(a,t){var o=this.options_,s=$(this.tplDialog_),e=$($("#tpl-bookmark-save-dialog-content").html()),i={trigger:"manual",container:o.dialogContainer,content:e,template:s,html:!0,placement:"auto bottom"};return t&&(i.viewport={selector:t,padding:5}),a.popover(i).on("shown.bs.popover",sensorsdata.bind(function(){$("body").bind("click.bookmarksave",sensorsdata.bind(function(a){var t=$(a.target||a.srcElement),o=this.getDialogId();o&&0===t.parents('div[id="'+o+'"]').size()&&this.close()},this))},this)).on("hide.bs.popover",function(){$("body").unbind("click.bookmarksave")}).on("hidden.bs.popover",sensorsdata.bind(function(){this.dialog_.find("#bookmark-save-dialog-form").show(),this.dialog_.find("#bookmark-save-dialog-footer").show(),this.dialog_.find("#bookmark-save-dialog-delete").hide(),this.dialog_.find("#bookmark-save-dialog-footer-delete").hide()},this)),s.add(e)},sensorsdata.BookmarkSave.prototype.setSaveBar_=function(a){var t=this.saveBarStyle_[a.id?"update":"add"],o=this.saveBar_.find('a[data-method="open-dialog"]');o.find("span:first").attr("class",t.className),o.find("span").eq(1).text(a.id?a.name:t.text),this.options_.disabled===!0&&(o.addClass("disabled").removeAttr("data-method"),o.find("span:first").attr("class",t.className).addClass("disabled"))},sensorsdata.BookmarkSave.prototype.toggleDisabledStatus=function(a){var t=this.saveBar_.find("div.bookmark-save-wrap > a");a?(t.addClass("disabled").removeAttr("data-method"),t.find("span:first").addClass("disabled")):(t.removeClass("disabled").attr("data-method","open-dialog"),t.find("span:first").removeClass("disabled"))},sensorsdata.BookmarkSave.prototype.renderInput_=function(a,t){if($.isEmptyObject(a))return!1;var o=this.dialog_.find("#bookmark-save-dialog-title");return o.toggle(this.options_.dialogTitleDisplay===!0),this.dialog_.find('div[data-for="bookmark-id"]').toggle(!!a.id),a.id&&this.dialog_.find('div[data-for="bookmark-id"] #bookmark-id').val(a.id),this.dialog_.find("#bookmark-name").val(a.name||""),this.renderDashboards_(t,a.dashboards),!0},sensorsdata.BookmarkSave.prototype.renderDashboards_=function(a,t){if($.isArray(a)){if(!this.options_.dashboardDisplay)return this.dialog_.find("div.form-group:last-child").hide(),void this.dialog_.find("div.form-group > p.help-block").show();var o=Mustache.render($("#tpl-bookmark-save-dialog-dashboards").html(),{dashboards:a}),s=this.dialog_.find("#bookmark-dashboard").html(o).find("select");s.multiselect("destroy"),s.multiselect({nonSelectedText:sensorsdata.languages.get(0===a.length?"请先创建数据概览<!--{en}Please create a dashboard first-->":"请选择数据概览<!--{en}Select dashboard-->"),enableCaseInsensitiveFiltering:!1}),$.isArray(t)&&t.length>0?s.multiselect("select",t):s.multiselect("deselectAll",!1)}},sensorsdata.BookmarkSave.prototype.saveBarClick_=function(a){var t=$(a.target||a.srcElement);t.attr("data-method")||(t=t.parents("[data-method]:first"));var o=t.attr("data-method");switch(o){case"open-dialog":var s=this.dialog_.find("#bookmark-save-dialog-title a.active").attr("data-method"),e=this.bookmark_;this.options_.dialogTitleDisplay===!0&&"switch-add"===s&&(e=this.newBookmark_);var i=sensorsdata.bind(function(a){this.dashboards_=a,this.renderInput_(e,this.dashboards_),this.show()},this);$.isArray(this.dashboards_)&&this.dashboards_.length>0?i(this.dashboards_):this.getDashboards_(i);break;case"refresh":!t.hasClass("refreshing")&&$.isFunction(this.options_.onRefreshClick)&&(this.btnRefresh_.addClass("refreshing"),sensorsdata.disableReportAjaxCache(),this.options_.onRefreshClick(sensorsdata.bind(function(){this.btnRefresh_.removeClass("refreshing")},this)),sensorsdata.enableReportAjaxCache());break;case"download":$.isFunction(this.options_.onDownloadClick)&&this.options_.onDownloadClick()}},sensorsdata.BookmarkSave.prototype.dialogClick_=function(a){var t=$(a.target||a.srcElement);t.attr("data-method")||(t=t.parents("[data-method]:first"));var o=this.options_,s=this.bookmark_.id,e=this.dialog_.find("#bookmark-save-dialog-form"),i=this.dialog_.find("#bookmark-save-dialog-footer"),n=this.dialog_.find("#bookmark-save-dialog-delete"),r=this.dialog_.find("#bookmark-save-dialog-footer-delete"),d=t.attr("data-method");switch(d){case"switch-add":$.extend(!0,this.bookmark_,this.buildBookmark_()),this.newBookmark_.name||(this.newBookmark_.name=this.bookmark_.name),this.getBookmarks_(function(a){this.newBookmark_.name=this.buildBookmarkName_(a,this.newBookmark_),this.renderInput_(this.newBookmark_,this.dashboards_)}),t.addClass("active").siblings().removeClass("active"),this.dialog_.find('[data-method="delete"]').hide();break;case"switch-update":this.newBookmark_=this.buildBookmark_(),this.renderInput_(this.bookmark_,this.dashboards_),this.dialog_.find('[data-method="delete"]').show(),t.addClass("active").siblings().removeClass("active");break;case"delete":n.find("#name-delete").text(this.bookmark_.name),$.isArray(this.bookmark_.dashboards)&&this.bookmark_.dashboards.length>0?n.find("#dashboard-delete").text(this.dialog_.find("#bookmark-dashboard span.multiselect-selected-text").text()).parent().show():n.find("#dashboard-delete").parent().hide(),this.dialog_.find("#bookmark-save-dialog-title").hide(),n.height(e.height()+15),e.hide(),i.hide(),n.show(),r.show();break;case"confirm-delete":sensorsdata.ajax({method:"DELETE",url:"bookmarks/bookmark/"+s,success:sensorsdata.bind(function(){this.close();var a=sensorsdata.unparam(window.location.hash);if("/dashboard/"===window.pageName){var t=this.bookmark_.dashboards||[];$.isNumeric(a.dashid)&&-1!==t.indexOf(parseInt(a.dashid,10))&&sensorsdata.indexPage.refresh()}this.newBookmark_=$.extend(!0,{},this.defaultBookmark_),this.bookmark_=$.extend(!0,{},this.defaultBookmark_),this.renderInput_(this.bookmark_,this.dashboards_),this.setSaveBar_(this.bookmark_),$.isFunction(o.onBookmarkDeleted)&&o.onBookmarkDeleted(s);var d=sensorsdata.CONSTSET.bookmarkId;delete a[d];var l="#"+$.param(a);window.history.pushState(l,"",l),$.isFunction(o.onBookmarkNameChanged)&&o.onBookmarkNameChanged(),this.options_.dialogTitleDisplay=!1,e.show(),i.show(),n.hide(),r.hide()},this)});break;case"cancel-delete":case"cancel":this.close();break;case"save":var l=null,h=1===this.dialog_.find('a.active[data-method="switch-update"]').size();if(h===!0){if(this.bookmark_.id&&this.bookmark_.user_id&&this.bookmark_.user_id!==sensorsdata.authority.userId)return void sensorsdata.info.show(sensorsdata.languages.get("无权更新其他人的书签，你可以保存为新书签<!--{en}No permission to update other people's bookmarks, you can save as a new bookmark-->"));this.bookmark_.dashboards=[],l=$.extend(!0,this.bookmark_,this.buildBookmark_())}else l=$.extend(!0,this.newBookmark_,this.buildBookmark_());this.save_(l);break;case"dashboard":case"bookmark-item":t.parent().hasClass("disabled")||(t.parents("ul:first").find("li.active").removeClass("active"),t.parents("li:first").addClass("active"),t.parents("div:first").find("span.selected").text(t.text()).attr("data-value",t.attr("data-value")))}},sensorsdata.BookmarkSave.prototype.save_=function(a){var t=sensorsdata.bind(function(a,t){var o=sensorsdata.unparam(window.location.hash),s=a.id+"",e=sensorsdata.CONSTSET.bookmarkId,i="";t?(o[e]=a.id,i="#"+$.param(o),window.history.pushState(i,"",i)):o[e]&&o[e]===s&&(i="#"+$.param(o),window.history.pushState(i,"",i))},this),o=sensorsdata.bind(function(a){if(a.id)sensorsdata.ajax({method:"POST",url:"bookmarks/bookmark/"+a.id,data:JSON.stringify(a),success:sensorsdata.bind(function(){this.close(),this.setSaveBar_(a),$.isFunction(this.options_.onBookmarkUpdated)&&this.options_.onBookmarkUpdated(a),t(a),$.isFunction(this.options_.onBookmarkNameChanged)&&this.options_.onBookmarkNameChanged()},this)});else{var o={success:!0,add_dashboard:a.dashboards.length>0,from_analytics:sensorsdata.CONSTSET.urlMap[a.type]};sensorsdata.ajax({method:"POST",url:"bookmarks/bookmark",data:JSON.stringify(a),error:function(a){o.success=!1,o.fail_reason=a.status,sensorsdata.track("create_bookmark",o)},success:sensorsdata.bind(function(s){return sensorsdata.track("create_bookmark",o),$.isEmptyObject(s)||!$.isNumeric(s.id)?void sensorsdata.error.show(sensorsdata.languages.get("保存书签失败，数据格式错误，请联系技术人员<!--{en}Fail to save the bookmark, the data format is error, please contact with the technicians-->")):(a.id=s.id,this.close(),this.bookmark_=a,this.setSaveBar_(a),this.dialog_.find('[data-method="delete"]').show(),this.newBookmark_=$.extend(!0,{},this.defaultBookmark_),this.dialog_.find("#bookmark-save-dialog-title").find('a[data-method="switch-update"]').addClass("active").siblings().removeClass("active"),this.options_.dialogTitleDisplay=!0,$.isFunction(this.options_.onBookmarkAdded)&&this.options_.onBookmarkAdded(a),t(a,!0),void($.isFunction(this.options_.onBookmarkNameChanged)&&this.options_.onBookmarkNameChanged()))},this)})}},this);this.getBookmarks_(function(t){a.name=this.buildBookmarkName_(t,a),o(a)})},sensorsdata.BookmarkSave.prototype.buildRelatedEvents_=function(a){var t=JSON.parse(a.data),o=[];if("/segmentation/"===a.type){var s=new sensorsdata.SegmentationBase;t=s.dealParam(t),o=s.getEventNamesFromParam(t.measures)}else if("/retention/"===a.type){var e=new sensorsdata.RetentionBase;t=e.dealParam(t),o.push(t.first_event.event_name),o.push(t.second_event.event_name)}else"/addiction/"===a.type&&(t=pages.RetentionAddiction.dealParam(t),o.push(t.event_name));return o},sensorsdata.BookmarkSave.prototype.buildBookmarkName_=function(a,t){var o=t.name,s=/^(\S+)\((\d+)\)$/,e=s.exec(o),i=0;$.isArray(e)&&3===e.length&&(o=e[1],i=parseInt(e[2],10)-1);for(var n in a)if(a.hasOwnProperty(n))for(var r=0,d=a[n].length;d>r;r++){var l=a[n][r];if(t.id&&t.id===l.id&&t.name===l.name)break;var h=a[n][r].name,m=a[n][r].id.toString();e=s.exec(h),$.isArray(e)&&3===e.length?(h=e[1],o===h&&(t.id||"").toString()!==m&&(i=parseInt(e[2],10)>i?parseInt(e[2],10):i)):0===i&&o===h&&(i=1)}return 0!==i?(o=o+"("+(parseInt(i,10)+1)+")",this.setName(o),o):t.name},sensorsdata.BookmarkSave.prototype.getBookmarks_=function(a){$.isFunction(a)&&(a=sensorsdata.bind(a,this),sensorsdata.ajax({url:"bookmarks/all",success:sensorsdata.bind(function(t){$.isPlainObject(t)&&a(t)},this)}))},sensorsdata.BookmarkSave.prototype.getDashboards_=function(a){$.isFunction(a)&&sensorsdata.ajax({url:"dashboards",success:sensorsdata.bind(function(t){$.isArray(t)&&a(t.filter(function(a){return a.user_id===sensorsdata.authority.userId}))},this)})},sensorsdata.BookmarkSave.prototype.getSamplingValue=function(a){return(!$.isNumeric(a)||0>a||a>6)&&(a=parseInt(this.saveBar_.find("#sampling-factor-slider").val(),10)),(0>a||a>6)&&(a=6),Math.pow(2,a)},sensorsdata.BookmarkSave.dealSamplingValue=function(a){return $.isNumeric(a)?(a=parseInt(a,10),Math.log(a)/Math.log(2)%1!==0?64:a>64?64:a):64},sensorsdata.BookmarkSave.prototype.buildBookmark_=function(){var a=$.extend(!0,{},this.defaultBookmark_);return a.name=this.dialog_.find("#bookmark-name").val(),this.options_.saveBarDisplay!==!0&&this.bookmark_.id||(a.type=window.location.pathname,a.data=this.buildBookmarkData_(),a.related_events=this.buildRelatedEvents_(a)),a.dashboards=[],this.dialog_.find("#bookmark-dashboard :checkbox:checked").each(function(t,o){var s=$(o).val();$.isNumeric(s)&&a.dashboards.push(parseInt(s,10))}),a},sensorsdata.BookmarkSave.prototype.buildBookmarkData_=function(){var a=window.location.pathname,t=sensorsdata.unparam(window.location.hash);if("/segmentation/"===a)t=(new sensorsdata.SegmentationBase).dealParam(t);else if("/retention/"===a){var o=new sensorsdata.RetentionBase;t=o.dealParam(t)}else"/addiction/"===a?t=pages.RetentionAddiction.dealParam(t):"/user_analytics/"===a?t=pages.UserAnalytics.dealParam(t):$.isArray(t.bucket_param)&&(t.bucket_param=sensorsdata.buildBucketPopoverValue(t.bucket_param),t.sampling_factor&&(t.sampling_factor=sensorsdata.BookmarkSave.dealSamplingValue(t.sampling_factor)));return JSON.stringify(t)},sensorsdata.BookmarkSave.buildTimeText=function(a){if(a.time)return sensorsdata.convertRelativeTimeLabel(a.time);var t=JSON.parse(a.data);if(t.from_date&&t.to_date){if("/segmentation/"===a.type){var o=sensorsdata.CONSTSET,s="hour"!==t.unit&&"minute"!==t.unit||t.compare_from_date||t.compare_to_date?o.dateFormat:sensorsdata.languages.get("YYYY-MM-DD HH时<!--{en}YYYY-MM-DD HH time-->");return moment(t.from_date,o.timeFormat).format(s)+o.dateRangeSplit+moment(t.to_date,o.timeFormat).format(s)}return t.from_date+sensorsdata.CONSTSET.dateRangeSplit+t.to_date}return""},sensorsdata.BookmarkSave.setRefreshButton=function(a,t){function o(){var a=sensorsdata.languages.get("数据更新时间：<!--{en}Data update time: -->")+n.format("M-D H:mm:ss")+" ";return r&&(a+=sensorsdata.languages.get("由于数据变化小于 1% ，系统没有更新数据。<!--{en}Because the data change is less than 1%, the system does not update the data.-->")),a+=sensorsdata.languages.get("点击按钮，强制刷新。<!--{en}Click on the button to force refresh.-->")}function s(){a.parents("body").length<=0?sensorsdata.languages.off("change",s):a.attr("data-original-title",o())}if(t.data_update_time&&t.report_update_time){var e=sensorsdata.CONSTSET.timeFormat,i=moment(t.data_update_time,e),n=moment(t.report_update_time,e);if(moment.isMoment(i)&&moment.isMoment(n)){var r=i.isAfter(n);sensorsdata.languages.on("change",s),a.toggleClass("changed",r).attr("data-original-title",o())}}};