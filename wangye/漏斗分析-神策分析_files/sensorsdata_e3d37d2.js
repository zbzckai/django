!function(){if(window.navigator&&window.navigator.userAgent){var e=window.navigator.userAgent.toLowerCase(),t=/(msie) ([\w.]+)/.exec(e);if(t){var a=t[5]||t[3]||t[1]||"",n=t[2]||t[4]||"0";if("msie"===a&&("6.0"===n||"7.0"===n||"8.0"===n||"9.0"===n)){var s=document.getElementById("sensorsdata-browser-info");s&&s.style&&(s.style.display="")}}}}();var sensorsdata=sensorsdata||{};switch(sensorsdata.languages=new h5i18n.Languages("cn",["title","src","label","placeholder","data-original-title","data-error-text"]),sensorsdata.languages.on("change",function(){$("html").attr("lang",this.locale)}),sensorsdata.languages.update(localStorage.sensorsdata_lang),sensorsdata.languages.locale){case"cn":$('[cmd="lang-cn"]').addClass("active");break;case"en":$('[cmd="lang-en"]').addClass("active")}$("body").on("click","[cmd]",function(){switch($(this).attr("cmd")){case"lang-cn":sensorsdata.languages.update("cn"),localStorage.sensorsdata_lang="cn";break;case"lang-en":sensorsdata.languages.update("en"),localStorage.sensorsdata_lang="en"}location.reload()}),function(){var e=$.fn.html;$.fn.html=function(){var t=e.apply(this,arguments);return arguments.length<=0&&(t=sensorsdata.languages.replace(t)),t}}(),sensorsdata.globalSet={showAjaxLoading:!0},sensorsdata.CONSTSET={relativeTime:function(){var e={};return e["昨日"]="1 day",e["今日"]="0 day",e["上周"]="last week",e["本周"]="0 week",e["上月"]="last month",e["本月"]="0 month",e["去年"]="last year",e["本年"]="0 year",e["过去 7 天"]="7 day",e["过去 30 天"]="30 day",e["过去 90 天"]="90 day",e["过去 180 天"]="180 day",e["过去 365 天"]="365 day",e["上线至今"]="-1 day",e.Yesterday="1 day",e.Today="0 day",e["Last week"]="last week",e["This week"]="0 week",e["Last month"]="last month",e["This month"]="0 month",e["Last year"]="last year",e["This year"]="0 year",e["Last 7 days"]="7 day",e["Last 30 days"]="30 day",e["Last 90 days"]="90 day",e["Last 180 days"]="180 day",e["Last 365 days"]="365 day",e["So far"]="-1 day",e}(),abandonedRelativeTime:{"0 day":"0 day","0 week":"0 week","0 month":"0 month","0 year":"0 year","1 day":"1 day","1 week":"7 day","1 month":"30 day","3 month":"90 day","6 month":"180 day","1 year":"365 day"},dateRangeLimit:{month:0,week:0,day:0,hour:30,minute:1},paginationSize:50,limit:1e3,roleRealtion:{0:sensorsdata.languages.get("管理员<!--{en}master-->"),1:sensorsdata.languages.get("分析师<!--{en}analyst-->"),2:sensorsdata.languages.get("普通用户<!--{en}user-->")},eventEmptyValue:"$Anything",eventEmptyText:sensorsdata.languages.get("任意事件<!--{en}Any Event-->"),everyEvent:{name:"$Anything",cname:sensorsdata.languages.get("任意事件<!--{en}Any Event-->"),pinyin:"ren yi shi jian",tag:[]},sessionGeneral:{name:"__session__",cname:sensorsdata.languages.get("Session总体<!--{en}Session totality-->")},letters:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],measureFunctions:{bounce_rate:{cname:sensorsdata.languages.get("跳出率<!--{en}Bounce rate-->"),unit:"%",type:"session",pinyin:"tiao chu lv"},exit_rate:{cname:sensorsdata.languages.get("退出率<!--{en}Exit rate-->"),unit:"%",type:"event",pinyin:"tui chu lv"},general:{cname:sensorsdata.languages.get("总次数<!--{en}Event Totals-->"),unit:sensorsdata.languages.get("次<!--{en}times-->"),type:"event",pinyin:"zong ci shu"},unique:{cname:sensorsdata.languages.get("触发用户数<!--{en}Unique Users-->"),unit:sensorsdata.languages.get("人<!--{en}people-->"),type:"event",pinyin:"chu fa yong hu shu"},average:{cname:sensorsdata.languages.get("人均次数<!--{en}Average-->"),unit:sensorsdata.languages.get("次<!--{en}times-->"),type:"event",pinyin:"ren jun ci shu"},SUM:{cname:sensorsdata.languages.get("总和<!--{en}Total-->"),field:!0,type:"property",pinyin:"zong he"},AVG:{cname:sensorsdata.languages.get("均值<!--{en}Mean value-->"),field:!0,type:"property",pinyin:"jun zhi"},MAX:{cname:sensorsdata.languages.get("最大值<!--{en}Max value-->"),field:!0,type:"property",pinyin:"zui da zhi"},MIN:{cname:sensorsdata.languages.get("最小值<!--{en}Min value-->"),field:!0,type:"property",pinyin:"zui xiao zhi"},uniqAvg:{cname:sensorsdata.languages.get("人均值<!--{en}Value per capita-->"),field:!0,type:"property",pinyin:"ren jun zhi"},uniqCount:{cname:sensorsdata.languages.get("去重数<!--{en}Deduplication-->"),unit:sensorsdata.languages.get("个<!--{en}-->"),field:!0,type:"property",pinyin:"qu chong shu"},count:{cname:sensorsdata.languages.get("用户数<!--{en}User Number-->"),unit:sensorsdata.languages.get("人<!--{en}people-->")},clickRate:{cname:sensorsdata.languages.get("点击率<!--{en}Click Rate-->"),unit:sensorsdata.languages.get("%<!--{en}%-->")},clickRatio:{cname:sensorsdata.languages.get("点击比<!--{en}Click Ratio-->"),unit:sensorsdata.languages.get("<!--{en}-->")}},sessionFunction:{general:sensorsdata.languages.get("Session 总次数<!--{en}Session Totals-->"),unique:sensorsdata.languages.get("触发用户数<!--{en}Unique Users-->"),average:sensorsdata.languages.get("人均 Session 次数<!--{en}Average-->")},propertyFunctions:{equal:{cname:sensorsdata.languages.get("等于<!--{en}equals to-->")},notEqual:{cname:sensorsdata.languages.get("不等于<!--{en}does not equal to-->")},less:{cname:sensorsdata.languages.get("小于<!--{en}less than-->")},greater:{cname:sensorsdata.languages.get("大于<!--{en}greater than-->")},between:{cname:sensorsdata.languages.get("区间<!--{en}range-->")},contain:{cname:sensorsdata.languages.get("包含<!--{en}includes-->")},notContain:{cname:sensorsdata.languages.get("不包含<!--{en}excludes-->")},isSet:{cname:sensorsdata.languages.get("有值<!--{en}has value -->")},notSet:{cname:sensorsdata.languages.get("没值<!--{en}has no value-->")},isEmpty:{cname:sensorsdata.languages.get("为空<!--{en}null -->")},isNotEmpty:{cname:sensorsdata.languages.get("不为空<!--{en}not null-->")},absolute_between:{cname:sensorsdata.languages.get("绝对时间<!--{en}Absolute time-->")},relative:{cname:sensorsdata.languages.get("相对当前时间点<!--{en}Be relative to current time -->")},relative_between:{cname:sensorsdata.languages.get("相对当前时间区间<!--{en}Be relative to current time range-->")},relative_event_time:{cname:sensorsdata.languages.get("相对事件发生时间<!--{en}Be relative to event occurrence time -->")},isTrue:{cname:sensorsdata.languages.get("为真<!--{en}True-->")},isFalse:{cname:sensorsdata.languages.get("为假<!--{en}False-->")},rlike:{cname:sensorsdata.languages.get("正则匹配<!--{en}Regular matches-->")},notrlike:{cname:sensorsdata.languages.get("正则不匹配<!--{en}Regular mismatches-->")}},filterRelation:{and:{cname:sensorsdata.languages.get("且<!--{en}and-->")},or:{cname:sensorsdata.languages.get("或<!--{en}or-->")}},monitorReference:{lastHour:{cname:sensorsdata.languages.get("上一小时<!--{en}Last one hour-->")},yesterdaySameHour:{cname:sensorsdata.languages.get("昨天同期<!--{en}Corresponding period of yesterday-->")},todayAverage:{cname:sensorsdata.languages.get("当日均值<!--{en}Average value of today-->")},yesterdayAverage:{cname:sensorsdata.languages.get("昨天均值<!--{en}Average value of yesterday-->")},yesterday:{cname:sensorsdata.languages.get("昨日<!--{en}Yesterday-->")},dayWeekBefore:{cname:sensorsdata.languages.get("上周同期<!--{en}Corresponding period of last week-->")},thisWeekAverage:{cname:sensorsdata.languages.get("当周均值<!--{en}Corresponding period of this week-->")},lastWeekAverage:{cname:sensorsdata.languages.get("上周均值<!--{en}Average value of last week-->")},lastMonth:{cname:sensorsdata.languages.get("上个月同期<!--{en}Corresponding period of last month-->")},last30DaysAverage:{cname:sensorsdata.languages.get("过去30天均值<!--{en}Average value of last 30 days-->")},none:{cname:sensorsdata.languages.get("特定值<!--{en}Specific value-->")}},projectKey:"sensorsdata-project",urlRememberKey:"sensorsdata-url-remember",metaMap:{event:sensorsdata.languages.get("事件<!--{en}Event-->"),property:sensorsdata.languages.get("属性<!--{en}Property-->"),session:"Session"},urlMap:{"/channel-manage/":sensorsdata.languages.get("渠道链接管理<!--{en}Utm manage-->"),"/segmentation/":sensorsdata.languages.get("事件分析<!--{en}Segmentation-->"),"/funnel/":sensorsdata.languages.get("漏斗分析<!--{en}Funnel-->"),"/retention/":sensorsdata.languages.get("留存分析<!--{en}Retention-->"),"/addiction/":sensorsdata.languages.get("分布分析<!--{en}Distribution-->"),"/clustering/":sensorsdata.languages.get("用户分群<!--{en}User Clustering-->"),"/cluster-detail/":sensorsdata.languages.get("分群结果<!--{en}Clustering results-->"),"/old-clustering/":sensorsdata.languages.get("用户分群<!--{en}User Clustering-->"),"/dashboard/":sensorsdata.languages.get("数据概览<!--{en}Dashboards-->"),"/events/":sensorsdata.languages.get("事件管理<!--{en}Events management-->"),"/auth/":sensorsdata.languages.get("权限管理<!--{en}Privilege management-->"),"/users/":sensorsdata.languages.get("用户列表<!--{en}Users-->"),"/import/":sensorsdata.languages.get("数据接入<!--{en}Data import-->"),"/sequence/":sensorsdata.languages.get("用户行为序列<!--{en}User behavior sequence-->"),"/demo/":sensorsdata.languages.get("无数据<!--{en}No data-->"),"/simulator/":sensorsdata.languages.get("数据模拟器<!--{en}Data simulator-->"),"/vtrack/":sensorsdata.languages.get("可视化埋点<!--{en}Visualized tracking-->"),"/track-manager/":sensorsdata.languages.get("数据管理中心<!--{en}Data management-->"),"/import-status/":sensorsdata.languages.get("导入状态<!--{en}Import status-->"),"/user_analytics/":sensorsdata.languages.get("属性分析<!--{en}Profile Analysis-->"),"/behavior-path/":sensorsdata.languages.get("用户行为路径<!--{en}Pathflow-->"),"/data-stream/":sensorsdata.languages.get("实时数据流查看<!--{en}Real time data-->"),"/web-click/":sensorsdata.languages.get("网页热力分析<!--{en}Thermal analysis of web pages-->"),"/app-click/":sensorsdata.languages.get("App 点击分析<!--{en}App Click-->"),"/web-click-map/":sensorsdata.languages.get("点击图<!--{en}Click map-->"),"/monitor-manager/":sensorsdata.languages.get("预警管理<!--{en}Alerts Management-->"),"/search-users/":sensorsdata.languages.get("搜索用户<!--{en}Search users-->"),"/interval/":sensorsdata.languages.get("间隔分析<!--{en}Interval Analytics-->"),"/profiling/":sensorsdata.languages.get("监控历史查询<!--{en}Query History-->"),"/no-result/":sensorsdata.languages.get("访问权限限制<!--{en}Access restriction-->"),"/lego/":sensorsdata.languages.get("数据指标<!--{en}Data metric-->")},urlMapOrder:{"/segmentation/":0,"/funnel/":1,"/retention/":2,"/addiction/":3},datetimeNames:{minute:sensorsdata.languages.get("分钟<!--{en}minute-->"),hour:sensorsdata.languages.get("小时<!--{en}hour-->"),day:sensorsdata.languages.get("天<!--{en}day-->"),week:sensorsdata.languages.get("周<!--{en}week-->"),month:sensorsdata.languages.get("月<!--{en}month-->")},minBodyWidth:800,mobilePages:["/dashboard/"],urlNoEvents:{"/auth/":"type=account","/events/":null,"/simulator/":null,"/track-manager/":null,"/vtrack/":null,"/track-manager/import-status/":null,"/data-stream/":null},bookmarkId:"bookmarkid",bucketSplit:"~",dateRangeSplit:sensorsdata.languages.get(" 至 <!--{en} To -->"),inputDateFormat:"YYYY-M-D",shortDateFormat:"M-D",shortTimeFormat:"M-D H:mm",normalTimeFormat:"YYYY-MM-DD HH:mm",timeFormat:"YYYY-MM-DD HH:mm:ss",dateFormat:"YYYY-MM-DD",timeInterval:{hour:36e5,day:864e5,week:6048e5,month:26784e5},cnWeekDay:{1:sensorsdata.languages.get("一<!--{en}Mon-->"),2:sensorsdata.languages.get("二<!--{en}Tue-->"),3:sensorsdata.languages.get("三<!--{en}Wed-->"),4:sensorsdata.languages.get("四<!--{en}Thu-->"),5:sensorsdata.languages.get("五<!--{en}Fri-->"),6:sensorsdata.languages.get("六<!--{en}Sat-->"),0:sensorsdata.languages.get("日<!--{en}Sun-->")},chartsColors:["#55ACEE","#4CDFC0","#FF9945","#FACF2A","#788CF0","#2DCA93","#FFC57F","#5F73F3","#F0938A","#68D9F0","#E1B13A","#AB9EDC","#71DB9E","#B99371","#57D4CF","#EE7A7A","#F7E16A","#409EFF","#E79734","#B2C9FF","#27D29C","#E0CD9E","#428CC1","#DCC510","#F2BCB5","#59ABFF","#7DC050","#A3E8E5"],engTypeToChs:{number:sensorsdata.languages.get("数值<!--{en}number-->"),string:sensorsdata.languages.get("文本<!--{en}string-->"),list:sensorsdata.languages.get("集合<!--{en}list-->"),bool:sensorsdata.languages.get("逻辑<!--{en}bool-->"),date:sensorsdata.languages.get("日期<!--{en}date-->"),datetime:sensorsdata.languages.get("时间<!--{en}datetime-->")},eventReg:/^((?!^distinct_id$|^original_id$|^time$|^properties$|^id$|^first_id$|^second_id$|^users$|^events$|^event$|^user_id$|^date$|^datetime$)[a-zA-Z_$][a-zA-Z\d_$]{0,99})$/i,unknownByValue:'<span class="value-unknown" data-toggle="tooltip" data-container="body" data-placement="right auto" title="没有设定该属性的值时，归为未知">[未知]</span>',unknownByValueText:sensorsdata.languages.get("[未知]<!--{en}Unknown-->"),emptyStringByValue:'<span class="value-unknown" data-toggle="tooltip" data-container="body" data-placement="right auto" title="该属性的值为空字符串">[空字符串]</span>',emptyStringByValueText:sensorsdata.languages.get("[空字符串]<!--{en}Empty String-->"),templateVariableTypes:{CONSTANT:sensorsdata.languages.get("常量<!--{en}Constant-->"),EVENT:sensorsdata.languages.get("事件<!--{en}Event-->"),EVENT_PROPERY:sensorsdata.languages.get("事件属性<!--{en}Event properties-->"),PROFILE_PROPERTY:sensorsdata.languages.get("用户属性<!--{en}User properties-->")},indexPageSidebarStatus:"sidebarStatus",emailReg:/^(\w-*\.*)+@(\w-?)+(\.\w+)+$/,channelDocument:"https://www.sensorsdata.cn/manual/channel_access.html#"},function(){var e={monitor:"alarms/alarm/{{id}}",monitorAll:"alarms",monitorReport:"alarms/report",guessSMTP:"email/smtp_config_guess?email={{email}}",emailConfig:"email/smtp_config{{#id}}/{{id}}{{/id}}",indicatorReverse:"events/custom/indicator/reverse",indicatorTransform:"events/custom/indicator/transform",eventProps:"event/{{eventName}}/properties",meta:"events/all?cache=false&invisible=true",virtual:"events/virtual",profile:"property/user/properties?show_all=true&cache=false",event:"property/all",session:"sessions/all",session_create:"sessions/session",meta_prop:"events/multimeta",meta_multi:"events/multimeta",profile_prop:"property/user/properties",profile_multi:"property/user/properties",event_prop:"property/meta",event_multi:"property/meta",session_delete:"sessions/session/{{id}}",virtual_delete:"event/virtual/{{id}}",session_multi:"sessions/multisession",virtual_multi:"events/multivirtual",virtual_create:"event/virtual",eventsClassifications:"events/classifications",eventsClassification:"events/classification/{{id}}",eventsCurrentClassification:"events/current_classification",tag:"tag",guide:"account/guide",dashboardsNav:"dashboards/navigation",dashboards:"dashboards{{#id}}/{{id}}{{/id}}",defaultQueryUserList:"users/list",defaultUserList:"users/list/save",segmentationUserList:"events/user/list/save",funnelUserList:"funnels/user/list/save",retentionUserList:"retentions/user/list/save",addictionUserList:"addictions/user/list/save",behaviorPathUserList:"path/analytics/user/list/save",webClickUserList:"heat_map/user/list/save",appClickUserList:"events/user/list/save",segmenterStatus:"segmenter/status",pinyin:"common/pinyin",allBookmarks:"bookmarks/all",bookmarks:"bookmarks/bookmark{{#id}}/{{id}}{{/id}}",eventProperties:"event/properties?events={{eventNames}}&method=mixed",userProperties:"property/user/properties",segmentation:"events/report/?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",funnel:"funnels/funnel/{{funnel_id}}/report?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",retention:"retentions/report/?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",addiction:"addictions/report/?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",user_analytics:"user/report/?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",behaviorPath:"path/analytics/report",webClick:"events/report/",funnelProperties:"funnels/funnel/{{id}}/properties",compareReport:"events/compare/report/?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",profiling_query:"profiling/service/queries",interval:"interval/report/?bookmarkId={{#bookmarkid}}{{bookmarkid}}{{/bookmarkid}}",streamStart:"supervise/start",streamGet:"supervise/get",streamStop:"supervise/stop",customWidget:"widget/custom/{{#id}}{{id}}{{/id}}",allWidgets:"widget/all",utm:"channel/report",chanelLink:"channel/link/{{#id}}{{id}}{{/id}}",channelLinks:"channel/links",channelSupported:"channel/supported",channelCampaigns:"channel/campaigns",channelCsv:"channel/csv",shortUrlCreate:"short_url/create",shortUrlExcelLoader:"short_url/excel_loader",shortUrlQuery:"short_url/query",account:"account",roles:"roles/all",login_qr_code:"app/login/qr",propertyValuse:"property/{{id}}/values{{#limit}}?limit={{limit}}{{/limit}}",post_pub_key:"common/pubkey"};sensorsdata.api={get:function(t,a){var n=e[t];return n&&(n=Mustache.render(n,a||{})),n}}}(),sensorsdata.util={arrayToMap:function(e,t){if(!(e instanceof Array))return e;var a={};return e.forEach(function(e){e.hasOwnProperty(t)&&(a[e[t]]=e)}),a},indicatorReverse:function(e,t){sensorsdata.ajax({url:sensorsdata.api.get("indicatorReverse"),method:"POST",data:JSON.stringify(e),success:t})},diff:function(e,t){if(e===t)return!0;if(e instanceof Array&&t instanceof Array){if(e.length!==t.length)return!1;for(var a=0,n=e.length;n>a;a++)if(!sensorsdata.util.diff(e[a],t[a]))return!1;return!0}if(e instanceof Object&&t instanceof Object){var s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return!1;for(var o in e)if(e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&!sensorsdata.util.diff(e[o],t[o]))return!1;return!0}return!1},numberFormat:function(e){var t=String(e).split("."),a=t[0],n=t[1];if(a.length<4)return e;var s=a.length%3;return(a.slice(0,s)+a.slice(s).replace(/(\d{3})/g,",$1")).replace(/^,/,"")+(n?"."+n:"")},format:function(e,t){return e.replace(/#\{(.*?)\}/g,function(e,a){return t&&a in t?t[a]:""})},intersection:function(e,t){var a=[];if(!$.isArray(e)||!$.isArray(t))return a;for(var n=0,s=e.length;s>n;n++)t.indexOf(e[n])>=0&&a.push(e[n]);return a},encodeCsvItem:function(e){return e=e||"",e=e.replace(/"/g,'""'),(e.indexOf(",")>-1||e.indexOf('"')>-1)&&(e='"'+e+'"'),e},arrayToCsv:function(e){return e=e||[],e.map(function(e){return sensorsdata.util.encodeCsvItem(e)}).join(",")},csvToArray:function(e){var t=/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/,a=/(?!\s*$)\s*(?:'([^'\\]*(?:\\[\S\s][^'\\]*)*)'|"([^"\\]*(?:\\[\S\s][^"\\]*)*)"|([^,'"\s\\]*(?:\s+[^,'"\s\\]+)*))\s*(?:,|$)/g;if(!t.test(e))return null;var n=[];return e.replace(a,function(e,t,a,s){return void 0!==t?n.push(t.replace(/\\'/g,"'")):void 0!==a?n.push(a.replace(/\\"/g,'"')):void 0!==s&&n.push(s),""}),/,\s*$/.test(e)&&n.push(""),n}},sensorsdata.Authority=function(e){this.userName=e.userName,this.userId=parseInt(e.userId,10),this.role=parseInt(e.role,10),this.isAdmin=0===this.role,this.isAnalyst=1===this.role,this.isNormal=2===this.role,this.eventPermission=e.eventPermission||{type:"ALL",events:[]},this.roleName=sensorsdata.CONSTSET.roleRealtion[this.role]||sensorsdata.CONSTSET.roleRealtion[2],this.setting={}},sensorsdata.Authority.prototype.getSetting=function(e){var t=this;return sensorsdata.ajax({url:"account/guide",showCommonError:!1,showLoader:!1,success:function(a){$.isFunction(e)&&e(a||{}),t.setting=$.extend(!0,{},a||{})}})},sensorsdata.Authority.prototype.updateSetting=function(e,t){var a=this;return sensorsdata.ajax({url:"account/guide",showCommonError:!1,showLoader:!1,success:function(n){e=$.extend(!1,{},n,e),sensorsdata.ajax({url:"account/guide",method:"POST",showCommonError:!1,showLoader:!1,data:JSON.stringify(e),success:function(){$.isFunction(t)&&t(e),a.setting=$.extend(!0,{},e||{})}})}})},sensorsdata.Authority.prototype.checkPageAuth=function(e){var t=["/simulator/","/vtrack/"],a=["/events/","/auth/"],n=!this.isAdmin&&t.indexOf(e)>=0||this.isNormal&&a.indexOf(e)>=0;return!n},sensorsdata.AJAX_CONST={BASE_URL:"/api/",REDIRECTING:!1,reportAjaxCache:!0,reportAjaxQueue:[],asyncReportAjaxQueue:[],queue:{},DEFAULT_OPTIONS:{cache:!1,useCache:!1,showCommonError:!0,customErrorStatusCode:-1,errorStatusCode:-1,showLoader:!0,dataType:"json",contentType:"application/json",timeout:3e4,queueEnable:!1,queueKey:"",queueOverwrite:!0}},sensorsdata.log=function(){"object"==typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},sensorsdata.loader={element:$("#ajax-loader"),loaderRelayFlag:[],loaderCount:0},sensorsdata.loader.show=function(e){sensorsdata.loader.loaderCount++;var t=window.setTimeout(function(){sensorsdata.loader.element.find("p").html(e||sensorsdata.languages.get("正在加载数据<!--{en}Data loading-->")),sensorsdata.loader.element.show()},200);sensorsdata.loader.loaderRelayFlag.push(t)},sensorsdata.loader.close=function(e){if(!(--sensorsdata.loader.loaderCount>0&&e!==!0)){e===!0&&(sensorsdata.loader.loaderCount=0);for(var t=sensorsdata.loader.loaderRelayFlag.pop();t;)window.clearTimeout(t),t=sensorsdata.loader.loaderRelayFlag.pop();sensorsdata.loader.element.hide()}},function(){var e=0;sensorsdata.guid=function(){return e++}}(),function(){var e={};sensorsdata.deferManager={add:function(t){if(!t||"function"!=typeof t.method)throw new Error("sensorsdata.deferManager: add 方法 options.method 参数必填，且必须为 function 类型");this.remove(t.name);var a=setTimeout(t.method,t.time||8e3);t.name&&(e[t.name]=a)},remove:function(t){t&&e[t]&&clearTimeout(e[t])}}}(),sensorsdata.message={containerId:"#sensorsdata-alert",linkDetailId:"#sensorsdata-alert-link-detail-{{id}}",tplsID:{def:"#tpl-sensorsdata-alert-item"},tplsHTML:{},showings:{},showingsMap:{},showingsMarkers:{},init:function(){if(!this.isInit){var e=this.tplsID;this.isInit=!0,this.$container=$(this.containerId),this.bind();for(var t in e)e.hasOwnProperty(t)&&Mustache.parse(this.tplsHTML[t]=$(this.tplsID[t]).html())}},bind:function(){var e=this;this.$container.delegate("a[data-action]","click",function(t){var a=this.getAttribute("data-action"),n=Number(this.getAttribute("data-id"));n>-1&&(e[a+"Handle"]?(t.preventDefault(),e[a+"Handle"](n)):e.showings[n]&&e.showings[n]["on"+a]&&(t.preventDefault(),e.showings[n]["on"+a](n)))})},show:function(e){if(e.content&&e.type&&("string"==typeof e.marker&&e.marker||!this.showingsMap[e.content])&&-1===window.location.search.indexOf("f=email")){e.marker&&this.showingsMarkers[e.marker]&&this.hide(this.showingsMarkers[e.marker].id),this.isInit||this.init();var t=this,a=this.processOptions(e),n=$(Mustache.render(this.getTpl(a.type),a));return a.$element=n,n.prependTo(this.$container).slideDown(function(){t.showPostprocessor(a)}),a.id}},processOptions:function(e){var t=sensorsdata.guid();return/\{\{id\}\}/.test(e.content)&&(e.sourceContent=e.content,e.content=e.content.replace(/\{\{id\}\}/g,t)),e.errorDetail&&(e.detail=this.createErrorDetail(e.errorDetail)),e.detail&&(e.isdetail=!0,e.isclose=!0),$.extend({id:t,autohide:!0,isclose:!1},e)},getTpl:function(e){return this.tplsHTML[e]||this.tplsHTML.def},showPostprocessor:function(e){this.saveItem(e),e.autohide&&this.autoClose(e),e.detail&&this.detailInit(e)},autoClose:function(e){var t=this,a="object"==typeof e?e:this.showings[e],n="number"==typeof a.duration&&a.duration>0?a.duration:500*a.content.length<7e3?500*a.content.length:7e3,s=function(){$(document.body).off("mouseover",s),a.timer=setTimeout(function(){a._event="auto",t.hide(a.id)},n)};$(document.body).on("mouseover",s)},detailInit:function(e){var t="object"==typeof e?e:this.showings[e];t.clipboard=new Clipboard(this.linkDetailId.replace("{{id}}",t.id)),t.clipboard.on("success",function(){clearTimeout(t.timer),t.$element.addClass("open-detail clip-ok")}),t.clipboard.on("error",function(){t.$element.addClass("open-detail clip-fail")})},hide:function(e){var t=this["number"==typeof e?"showings":"showingsMap"][e];if(t){var a=this;t.$element.slideUp(function(){a.hidePostprocessor(t)})}},hidePostprocessor:function(e){"function"==typeof e.onclose&&e.onclose({eventType:e._event}),this.deleteItem(e.id)},hideAll:function(){var e=this.showings;for(var t in e)e.hasOwnProperty(t)&&this.hide(e[t].id)},saveItem:function(e){this.showings[e.id]=e,this.showingsMap[e.sourceContent||e.content]=e,"string"==typeof e.marker&&e.marker&&(this.showingsMarkers[e.marker]=e)},deleteItem:function(e){var t=this.showings[e];t.clipboard&&t.clipboard.destroy(),t.$element.remove(),delete this.showings[t.id],delete this.showingsMap[t.sourceContent||t.content],"string"==typeof t.marker&&t.marker&&delete this.showingsMarkers[t.marker]},onDocumentClick:function(){var e=this;$(document).bind("click.message",function(t){var a=$(t.target);a.parents(".sensorsdata-alert-item").size()||e.hideAll()}),this.isOnDocumentClick=!0},offDocumentClick:function(){$(document).unbind("click.message"),this.isOnDocumentClick=!1},closeHandle:function(e){this.showings[e]._event="click",this.hide(e)},reloadHandle:function(e){var t=this.showings[e];"function"==typeof t.onreload&&t.onreload(),location.reload()},createErrorDetail:function(e){if(e){var t=[{name:sensorsdata.languages.get("页面诊断报告<!--{en}Profiling Report-->"),value:"<a href=\"javascript:void(0)\" onclick=\"try { saveTextAs(sensorsdata.profiling.get(), 'profiling_page_' + Date.now() + '.txt') } catch(e) {}\">"+sensorsdata.languages.get("点击下载<!--{en}Download-->")+"</a>"},{name:sensorsdata.languages.get("当前版本<!--{en}Current version-->"),value:sensorsdata.cache.config.build_version},{name:sensorsdata.languages.get("当前时间<!--{en}Current time-->"),value:moment().format("YYYY-MM-DD hh:mm:ss")},{name:sensorsdata.languages.get("当前浏览器<!--{en}Current browser-->"),value:$.browser.name+" "+$.browser.version},{name:sensorsdata.languages.get("当前浏览器地址<!--{en}Current browser address-->"),value:location.href},{name:sensorsdata.languages.get("异常信息<!--{en}Abnormal information-->"),value:e}];return/^url=\/api\/\w+\/report/.test(e)&&t.splice(1,0,{name:sensorsdata.languages.get("查询诊断报告<!--{en}Query Profiling Report-->"),value:'<a href="/api/profiling/query?needQueryResponse=true&needImpalaProfiling=false&project='+sensorsdata.cache.project.name+'">'+sensorsdata.languages.get("点击下载<!--{en}Download-->")+"</a>"}),t}}},$.each(["success","warning","info","error","trackInfo"],function(e,t){var a="trackInfo"===t?"warning":t;sensorsdata[t]={show:function(e){var t="object"==typeof e?e:{content:e};return t.type=a,sensorsdata.message.show(t)},hide:function(e){sensorsdata.message.hide(e)}}}),function(){function e(e){this.options=$.extend({template:t.tplHTML,width:800,isloading:!1,isListenAction:!0},e),this.init()}$.extend(e.prototype,sensorsdata.EventsModule,{init:function(){var e=this;this.__id__=sensorsdata.guid(),this.$container=$(Mustache.render(this.options.template,{title:this.options.title,content:this.options.content})).css("width",this.options.width).css("right",-this.options.width).hide().appendTo($("body")),this.$title=this.$container.find(".title"),this.$content=this.$container.find(".content"),this.options.isListenAction&&this.$content.delegate("[data-method]","click",function(t){t.preventDefault(),t.$target=$(this),e.trigger("click",t)})},show:function(e,t,a){if(!this.isshow){var n=this;this.isshow=!0,this.setTitle(e),this.setContent(t),this.options.isloading&&this.showLoading(),this.trigger("show",{isauto:a}),this.$container.show().animate({right:0},function(){n.trigger("showed",{isauto:a})})}},hide:function(e,t){if(this.isshow){var a=this;this.isshow=!1,this.trigger("hide",{isback:e===!1?!1:!0,isauto:t}),this.$container.animate({right:-this.options.width},function(){a.$container.hide(),a.trigger("hid")})}},setTitle:function(e){"string"==typeof e&&(this.$title.html(e),this.$title.find("[data-original-title]").tooltip())},setContent:function(e){"string"==typeof e&&this.$content.html(e)},showLoading:function(){this.$container.data("isloading")||this.$container.addClass("loading").data("isloading",!0)},closeLoading:function(){this.$container.data("isloading")&&this.$container.removeClass("loading").data("isloading",!1)},destroy:function(){this.trigger("destroy"),this.$container.remove(),this.$container=this.$title=this.$content=this.hide=this.show=null}});var t={$mask:$('<div style="display:none;width:100%;height:100%;position:absolute;left:0;top:0;background:#000;opacity:0.7;z-index:1800;"></div>'),tplID:"#tpl-sensorsdata-slidepage",tplHTML:"",pages:{},history:[],init:function(){var e=this;this.isinit=!0,this.$html=$("html"),this.$body=$("body"),Mustache.parse(this.tplHTML=$(this.tplID).html()),$("body").append(this.$mask.click(function(){e.closePages()}))},createPage:function(t){var a=this,n=new e(t);return this.pages[n.__id__]=n,n.on("show",function(e){a.onShow(n,e)}),n.on("hide",function(e){a.onHide(n,e)}),n.on("destroy",function(){a.destroy(n)}),n},onShow:function(e,t){if(!t||!t.isauto){var a=this.history[this.history.length-1];void 0!==a&&this.pages[a].hide(!0,!0)}this.showMask(),this.historyUpdate(e.__id__,"show")},onHide:function(e,t){if(!t||t.isauto!==!0)if(t&&t.isback===!1)this.hideMask(),this.history=[];else{var a=this.history;this.historyUpdate(e.__id__,"hide"),a.length?this.pages[a[a.length-1]].show(!1,!1,!0):this.hideMask()}},historyUpdate:function(e,t){var a=this.history;if("show"===t)e!==a[a.length-1]&&a.push(e);else if("hide"===t){var n=a.lastIndexOf(e);n>-1&&a.splice(n)}},closePages:function(){this.hideMask();var e=this.history[this.history.length-1];void 0!==e&&this.pages[e].hide(!0,!0),this.history=[]},showMask:function(){this.$mask.data("isshow")||(this.getdefaultOverflow(),this.bodyOverflowHidden(),this.$mask.show().data("isshow",!0))},hideMask:function(){this.$mask.data("isshow")&&(this.$mask.hide().data("isshow",!1),this.resetBodyOverflow())},getdefaultOverflow:function(){this.defaultOverflow={html:this.$html.css("overflow"),body:this.$body.css("overflow")}},bodyOverflowHidden:function(){this.$html.css("overflow","hidden"),this.$body.css("overflow","hidden")},resetBodyOverflow:function(){this.$html.css("overflow",this.defaultOverflow.html),this.$body.css("overflow",this.defaultOverflow.body)},destroy:function(e){delete this.pages[e.__id__]}};sensorsdata.createSlidePage=function(e){return t.isinit||t.init(),t.createPage(e)}}(),sensorsdata.inherits=function(e,t){function a(){}a.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new a,e.prototype.constructor=e},sensorsdata.bindNative_=function(e){return e.call.apply(e.bind,arguments)},sensorsdata.bindJs_=function(e,t){if(!e)throw new Error;if(arguments.length>2){var a=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,a),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},sensorsdata.bind=function(){return sensorsdata.bind=Function.prototype.bind&&-1!==Function.prototype.bind.toString().indexOf("native code")?sensorsdata.bindNative_:sensorsdata.bindJs_,sensorsdata.bind.apply(null,arguments)},function(){function e(t,a,n){var s,r=/\[\]$/;if($.isArray(a))$.each(a,function(a,s){r.test(t)?n(t,s):e(t+"["+("object"==typeof s?a:"")+"]",s,n)});else if("object"===$.type(a))for(s in a)a.hasOwnProperty(s)&&e(t+"["+s+"]",a[s],n);else n(t,a)}$.extend({paramFix:function(t){var a,n=[],s=function(e,t){t=$.isFunction(t)?t():t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};for(a in t)t.hasOwnProperty(a)&&e(a,t[a],s);return n.join("&")}})}(),sensorsdata.unparam=function(e){var t=(e+"").indexOf("#");-1!==t&&(e=e.substr(t+1));var a=decodeURIComponent(e);if("{"===a[0])return JSON.parse(a.substring(0));var n={};if(!e)return n;try{for(var s=function(e,t,a){if(!t)return e;var n=/^\[([a-zA-Z-_\d$.]*)\]/,r=n.exec(t),o=r[1];return o?(e=$.isNumeric(o)?e||[]:e||{},e[o]=r[0]===t?a:s(e[o],t.substr(r[0].length),a)):($.isArray(e)||(e=[]),e.push(a)),e},r=e.split("&"),o=/([a-zA-Z-_\d$.]*)\[([a-zA-Z-_\d$.]*)\]/,i=0,l=r.length;l>i;i++){var u=r[i].split("="),d=decodeURIComponent((u[0]||"").replace(/\+/g,"%20")),c=decodeURIComponent((u[1]||"").replace(/\+/g,"%20")),g=o.exec(d);if($.isArray(g)){var p=g[1];n[p]=s(n[p],d.substr(p.length),c)}else n[d]=c}}catch(m){return sensorsdata.info.show(sensorsdata.languages.get("您输入的浏览器链接不合法，已使用默认参数<!--{en}The browser link you entered is not valid. The default parameter has been used-->")),{}}return n},sensorsdata.cache={sessions:[],events:[],partitions:[],ajax:{},errors:{},licenseItems:[],config:{},project:{},appPushConfigs:[]},sensorsdata.download=function(e,t,a,n){sensorsdata.track("download");
var s=$("#common-file-download-form");if(t&&s.find('input[name="form_data"]').val(JSON.stringify(t)),a&&s.find('input[name="filename"]').val(a),$.isEmptyObject(n))s.find('input[name="detail"]').remove();else{var r=s.find('input[name="detail"]');0===r.size()&&(r=s.append('<input name="detail" type="hidden" value="">').find('input[name="detail"]')),r.val(JSON.stringify(n))}if(sensorsdata.cache.project.name){var o=e.split("?");1===o.length?(o=e.split("#"),1===o.length?e+="?project="+sensorsdata.cache.project.name:e=o[0]+"?project="+sensorsdata.cache.project.name+"#"+o[1]):e=o[0]+"?project="+sensorsdata.cache.project.name+"&"+o[1]}s.attr("action",sensorsdata.AJAX_CONST.BASE_URL+e).submit()},sensorsdata.ajaxCache=function(e){var t="";if(e.type=e.type||"GET",t=e.param&&!$.isEmptyObject(e.param)?e.url+e.type+$.param(e.param):e.url+e.type,!e.data){var a=10,n=sensorsdata.cache.ajax[t];return n&&n.timestamp&&moment().unix()-n.timestamp<=a?n.data:null}sensorsdata.cache.ajax[t]={data:e.data,timestamp:moment().unix()}},sensorsdata.disableReportAjaxCache=function(){sensorsdata.AJAX_CONST.reportAjaxCache=!1},sensorsdata.enableReportAjaxCache=function(){sensorsdata.AJAX_CONST.reportAjaxCache=!0},sensorsdata.reportAjax=function(e){var t=$.extend(!0,{},e),a=(new Date).getTime()+":"+String(Math.floor(1e8*Math.random())).substr(0,6),n=sensorsdata.AJAX_CONST.reportAjaxCache,s=t.isAsync,r=$.Deferred(),o=500;if(t.requestId=a,t.timeout=0,t.myTimeout=t.myTimeout||5e3,t.isReportAjax=!0,$.isEmptyObject(t.data))t.url+=-1===t.url.indexOf("?")?"?request_id="+a:"&request_id="+a,-1===t.url.indexOf("use_cache")&&(t.url+="&use_cache="+n);else{t.data.request_id=a,void 0===t.data.use_cache&&(t.data.use_cache=n),s&&(t.url=t.url+=t.url.indexOf("?")>-1?"&async=true&timeout="+t.myTimeout/1e3:"?async=true&timeout="+t.myTimeout/1e3);var i=sensorsdata.unparam(window.location.hash);i.dashid&&parseInt(i.dashid,10)>=0&&(t.data.dashboard_id=parseInt(i.dashid,10)),t.data=JSON.stringify(t.data)}var l,u=function(){for(var e=0,t=sensorsdata.AJAX_CONST.reportAjaxQueue.length;t>e;e++){var n=sensorsdata.AJAX_CONST.reportAjaxQueue[e];if(n.options.requestId===a){sensorsdata.AJAX_CONST.reportAjaxQueue.splice(e,1),sensorsdata.execReportAjaxQueue(),n.defer&&$.isFunction(n.defer.resolve)&&n.defer.resolve();break}}};if(s)if($.isFunction(t.complete)?(l=t.complete,t.finalComplete=function(){u(),l.apply(this,arguments)}):t.finalComplete=u,$.isFunction(t.error)){var d=t.error;t.error=function(){u(),d.apply(this,arguments)}}else t.error=u;else $.isFunction(t.complete)?(l=t.complete,t.complete=function(){u(),l.apply(this,arguments)}):t.complete=u;var c=function(e,a){if(e&&e.request_id&&!e.is_done){var n=null;sensorsdata.AJAX_CONST.asyncReportAjaxQueue.push(e.request_id),sensorsdata.asyncReportAjax(e.request_id,a,t.finalComplete,r,n),n=setInterval(function(){sensorsdata.asyncReportAjax(e.request_id,a,t.finalComplete,r,n)},o)}else a(e),r.resolve(),$.isFunction(t.finalComplete)&&t.finalComplete()},g=t.success;t.success=function(e){c(e,g)};var p=sensorsdata.AJAX_CONST.reportAjaxQueue,m=p.filter(function(e){return null!==e.jqXHR}).length;if(5>m){var h=sensorsdata.ajax(t);p.push({options:t,jqXHR:h})}else p.push({options:t,jqXHR:null,defer:r});return r},sensorsdata.asyncReportAjax=function(e,t,a,n,s){var r,o="async/result?request_id="+e,i=function(){r=sensorsdata.AJAX_CONST.asyncReportAjaxQueue.indexOf(e),a(),clearInterval(s),s=null,-1!==r&&sensorsdata.AJAX_CONST.asyncReportAjaxQueue.splice(r,1)};sensorsdata.ajax({method:"get",useCache:!1,url:o,showLoader:!0,success:function(a){r=sensorsdata.AJAX_CONST.asyncReportAjaxQueue.indexOf(e),a&&a.is_done&&-1!==r?(sensorsdata.loader.close(),n.resolve(),i(),t(JSON.parse(a.result))):(a&&a.is_done||a.error||-1===r)&&(clearInterval(s),s=null)},error:function(){i()}})},sensorsdata.execReportAjaxQueue=function(){for(var e=sensorsdata.AJAX_CONST.reportAjaxQueue,t=0;t<e.length;t++){var a=e[t];if(a&&null===a.jqXHR){a.jqXHR=sensorsdata.ajax(a.options);break}}},sensorsdata.cancelReportAjax=function(e){var t=sensorsdata.AJAX_CONST.reportAjaxQueue;($.isNumeric(e)||"string"==typeof e)&&(e=t.filter(function(t){return t.options.requestId+""==e+""})[0]),e&&!$.isEmptyObject(e.options)&&(t.splice(t.indexOf(e),1),e.jqXHR&&$.isFunction(e.jqXHR.abort)&&e.jqXHR.abort(),e.defer&&$.isFunction(e.defer.resolve)&&e.defer.resolve(),sensorsdata.ajax({method:e.options&&e.options.isAsync?"DELETE":"POST",showCommonError:!1,url:e.options&&e.options.isAsync?"async/cancel?request_id=":"query/cancel?requestId="+e.options.requestId,error:function(){console.log("cancel query failed, request id is "+e.options.requestId)},success:function(){console.log("cancel query success, request id is "+e.options.requestId)}}))},sensorsdata.clearReportAjax=function(){for(var e=sensorsdata.AJAX_CONST.reportAjaxQueue;e.length>0;)sensorsdata.cancelReportAjax(e[0],!0,!0)},sensorsdata.buildAjaxError=function(e,t){var a=sensorsdata.languages.get("查询数据异常，请稍后刷新重试<!--{en}Query data exception. Please try again later-->");if((412===e||422===e)&&!$.isEmptyObject(t)&&t.error){a=sensorsdata.languages.get("请求参数中项目或事件或属性不存在<!--{en}The item or event or property does not exist in the request parameter-->");var n=t.error.split(" "),s=n[0]||"",r=(n[1]||"").split(".").pop();s&&r&&(a=sensorsdata.util.format(sensorsdata.languages.get("请求中的 #{type} #{name} 不存在<!--{en}The #{type} #{name} in the request does not exist-->"),{type:sensorsdata.CONSTSET.metaMap[s]||s,name:r}))}return a},sensorsdata.ajax=function(e){if(!e||!e.url)throw"ajax param is null.";var t=$.extend(!0,{},sensorsdata.AJAX_CONST.DEFAULT_OPTIONS),a=$.extend(!0,t,e);a.showLoader=!1;var n=a.showLoader===!0,s="",r=$.Deferred();if(r.resolve(),a.useCache===!0){var o=sensorsdata.ajaxCache({url:a.url,type:a.type,param:a.data});if(o)return a.success(o),r;var i=a.success;!function(e,t,n){a.success=function(a){var s=$.extend(!0,$.isArray(a)?[]:{},a);sensorsdata.ajaxCache({url:e,param:t,type:n,data:s}),i.apply(this,arguments)}}(a.url,a.data,a.type)}if(a.queueEnable===!0){a.queueKey=a.queueKey||a.method+a.url;var l=sensorsdata.AJAX_CONST.queue[a.queueKey];if(!$.isEmptyObject(l)){if(a.queueOverwrite!==!0)return r;console.log("ajax abort "+a.queueKey),l.requestId?sensorsdata.cancelReportAjax(l.requestId):l.jqXHR.abort()}}var u={timeout:"查询超时，请稍后重试<!--{en}The query timed out. Please try again later-->",timeout2:"请检查网络连接是否断开<!--{en}Please check that the network connection is disconnected-->",timeout3:"请求超时，请稍后重试<!--{en}The request timed out. Please try again later-->",loginExpired:'您的登录状态已过期，请<a href="#{loginUrl}">重新登录</a><!--{en}Your login status has expired, please<a href="#{loginUrl}">Log in again</a>-->',timelyRenew:"系统的 #{name} 超出授权，请及时续费<!--{en}The #{name} system exceed the authorization, please timely renew.-->",renewTimely:"系统某限制超出授权，请及时付费<!--{en}System limits exceeded authorization,please renew timely -->",noPermission:"没有权限，请向管理员申请此模块的权限<!--{en}No permission,please apply to the administrator for the permission of this module-->",noModulePermission:"没有权限，请向管理员申请此模块的权限<!--{en}No permission,please apply to the administrator for the permission of this module-->",noInterface:"请求的接口不存在<!--{en}The requested interface does not exist-->",noProject:"请求参数中项目不存在<!--{en}The project in the request parameter does not exist-->",requestFailed:"请求失败：<!--{en}Request failed -->",unknownReason:"请求失败，原因未知，请联系值班同学<!--{en}Request failed, unknown reason, please contact with staff on duty-->",unresponsive:"服务无响应，请稍后重试<!--{en}The service is unresponsive. Please try again later-->",formatIncorrect:"数据格式错误，请联系值班同学<!--{en}The data format is incorrect, please contact with staff on duty-->",get:function(e,t){if(!this[e])return"";var a=sensorsdata.languages.get(this[e]);return t&&(a=sensorsdata.util.format(a,t)),a}},d={0:function(e){return u.get("timeout"===e.jqStatusText?/^\/api\/\w+\/report/.test(a.url)?"timeout":"timeout3":"timeout2")},400:function(e){return e.responseJSON&&e.responseJSON.error?u.get("requestFailed")+e.responseJSON.error:u.get("unknownReason")},401:function(){var e="";sensorsdata.AJAX_CONST.REDIRECTING=!0;var t=sensorsdata.buildLoginUrl();return e=u.get("loginExpired",{loginUrl:t}),window.setTimeout(function(){window.location.href=t},3e3),e},403:function(e){return e&&e.responseJSON&&e.responseJSON.error||u.get("noPermission")},404:function(){return u.get("noInterface")},412:function(e){var t=parseInt(e.status,10);return sensorsdata.cache.errors[window.location.pathname+window.location.hash]=t,sensorsdata.buildAjaxError(t,e.responseJSON)},418:function(){var e=null;return $.isArray(sensorsdata.cache.licenseItems)&&sensorsdata.cache.licenseItems.length>0&&(e=sensorsdata.cache.licenseItems.filter(function(e){return e.isMatch})[0]),e?u.get("timelyRenew",e):u.get("renewTimely")},500:function(e){return e&&e.responseJSON&&e.responseJSON.error||u.get("unresponsive")},503:function(){return u.get("noProject")},599:function(){return u.get("unknownReason")}};d[422]=d[412];var c=function(e,t){var n=parseInt(e.status,10);if(n!==a.customErrorStatusCode||n===a.errorStatusCode){if(0===n&&"abort"===t)return console.log("ajax be aborted by queue"),r;if(401===n&&sensorsdata.AJAX_CONST.REDIRECTING===!0)return r;var s=t;e.jqStatusText=t;var o=d[n]?n:n>=400&&500>n?400:n>500&&503!==n?599:-1;if(d[o]?s=d[o](e):"object"==typeof e.responseJSON&&"string"==typeof e.responseJSON.error&&(s=e.responseJSON.error),"parsererror"===t&&(s=u.get("formatIncorrect")),a.showCommonError===!0&&s){var i=["url="+a.url,"statusText="+t,"statusCode="+n];e.responseText&&!/<.+>/.test(e.responseText)&&i.push("responseText="+e.responseText.replace(/<|>/g,""));var l={content:s,duration:6e3};401!==n&&(l.errorDetail=i.join("<br>")),window.ErrorStatistics.track({code:n,reason:s,api:a.url}),sensorsdata.error.show(l)}}};if($.isFunction(a.error)){if(a.isCommonError!==!1){var g=a.error;a.error=function(e,t){c(e,t),g(e,t)}}}else a.error=c;$.isFunction(a.errorFunc)&&(a.error=function(e,t){a.errorFunc(e,t,c)});var p=a.complete;a.complete=function(e,t){sensorsdata.profiling.pushHTTP(e,a),n!==!0||a.isReportAjax||sensorsdata.loader.close(),a.queueKey&&sensorsdata.AJAX_CONST.queue[a.queueKey]&&delete sensorsdata.AJAX_CONST.queue[a.queueKey],$.isFunction(p)&&p(e,t)},a.headers={},0!==a.url.indexOf("/")&&(a.url=sensorsdata.AJAX_CONST.BASE_URL+a.url),sensorsdata.cache.project.name&&(a.headers[sensorsdata.CONSTSET.projectKey]=sensorsdata.cache.project.name),n===!0&&sensorsdata.loader.show(),a.cache=!1,a.isEncrypt===!0&&this.ajax({url:"/api/common/pubkey",async:!1,success:function(e){if(!$.isEmptyObject(e)&&e.hasOwnProperty("public")){var t=e.public,n=new JSEncrypt,r=CryptoJS.enc.Utf8.parse(Math.floor(1e6*Math.random())+Date.now()).toString();n.setPublicKey(t);var o=n.encrypt(r),i=CryptoJS.lib.WordArray.random(16),l=CryptoJS.lib.WordArray.random(16),u=CryptoJS.PBKDF2(r,i,{keySize:4,iterations:100}),d=CryptoJS.AES.encrypt(a.data,u,{iv:l,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});$.extend(!0,a.headers,{"Aes-Salt":i.toString(),"Aes-Iv":l.toString(),"Aes-Passphrase":o}),a.data=d.toString();var c={pub_key:t,random:r.toString(),"Aes-Passphrase":o.toString(),"Aes-Salt":i.toString(),"Aes-Iv":l.toString(),key128Bits100Iterations:u.toString(),body:d.toString()};s=JSON.stringify(c)}}});var m=$.ajax(a);return a.isEncrypt===!0&&(m.encryptText=s),a.queueEnable===!0&&(sensorsdata.AJAX_CONST.queue[a.queueKey]={requestId:a.requestId,jqXHR:m}),m},sensorsdata.buildLoginUrl=function(e,t){t=t||sensorsdata.cache.project.name||sensorsdata.getLocationSearch().project;var a=[];if(t&&a.push("project="+t),e!==!1){var n=window.location.pathname+window.location.search+window.location.hash;a.push("to="+encodeURIComponent(n))}var s="/login/index.html";return 0===a.length?s:s+"?"+a.join("&")},sensorsdata.setCommonProperty=function(e){if($.isEmptyObject(e)||!$.isArray(e.event)||0===e.event.length)return e;var t=$.extend(!0,{},e),a="$";if(-1!==t.event[0].event_id&&-1===t.event[0].name.indexOf(a))return t;for(var n=-1===t.event[0].event_id,s=0,r=t.event.length;r>s;s++)if(n){if(-1!==t.event[s].event_id&&s-1>=0){t.event[s-1].endCommonProp=!0;break}}else if(-1===t.event[s].name.indexOf(a)&&s-1>=0){t.event[s-1].endCommonProp=!0;break}return t},sensorsdata.convertProperty=function(e,t){var a=[];if(t)for(var n in e)e.hasOwnProperty(n)&&$.isArray(e[n])&&(e[n]=e[n].filter(function(e){return e.is_dimension!==!1}));var s=function(e,t){var a=[];return $.isNumeric(t.funnel_step)&&a.push(t.funnel_step),a.push(e),t.event_name&&a.push(t.event_name),a.push(t.name),a.join(".")};if($.isArray(e.session)&&e.session.length>0&&a.push({label:sensorsdata.languages.get("Session 属性<!--{en}Session properties-->"),icon:"icon-session-property",items:e.session.map(function(e){return e.fullName=s("session",e),e})}),$.isArray(e.event)&&e.event.length>0)if(e.event[0].hasOwnProperty("funnel_step")){var r=function(e,t){return-1===e?sensorsdata.languages.get("任意步骤<!--{en}Any Step-->"):sensorsdata.findEventCname(t)};e.event[0].fullName=s("event",e.event[0]);var o=[e.event[0]];e.event.reduce(function(e,t){return t.fullName=s("event",t),e.funnel_step!==t.funnel_step&&(a.push({label:r(e.funnel_step,e.event_name),icon:"icon-funnel-step,icon-event-property",iconValue:e.funnel_step+1,items:o}),o=[]),o.push(t),t});var i=o[o.length-1];a.push({label:r(i.funnel_step,i.event_name),icon:"icon-funnel-step,icon-event-property",iconValue:i.funnel_step+1,items:o})}else{var l=[],u=[];e.event.map(function(e){e.fullName=s("event",e),-1===e.event_id||0===e.name.indexOf("$")?l.push(e):u.push(e)}),l.length>0&&a.push({label:sensorsdata.languages.get("事件属性<!--{en}Event properties-->"),icon:"icon-event-property",items:l}),u.length>0&&a.push(0===l.length?{label:sensorsdata.languages.get("事件属性<!--{en}Event properties-->"),icon:"icon-event-property",items:u}:{label:"",icon:"",items:u})}if($.isArray(e.user)&&e.user.length>0){var d=[],c=[];e.user.map(function(e){e.fullName=s("user",e),e.is_segmenter?c.push(e):d.push(e)}),d.length>0&&a.push({label:sensorsdata.languages.get("用户属性<!--{en}User properties-->"),icon:"icon-user-property",items:d}),c.length>0&&a.push({label:sensorsdata.languages.get("用户分群<!--{en}User Clustering-->"),icon:"icon-profiling",items:c})}return a},sensorsdata.seniorSort=function(e,t){function a(e,t,n){var s=String(e).charAt(n),r=String(t).charAt(n);return s===r&&""!==s&&""!==r?a(e,t,++n):r.localeCompare(s)}if(!$.isArray(e)||0===e.length)return e;var n=null,s=!1,r=arguments;return 1===arguments.length?($.each(e,function(e,t){"number"!=typeof t&&(s=!0)}),e.sort(s?function(e,t){return a(e,t,0)}:function(e,t){return t-e})):(n=2===arguments.length?function(e){return e[t]}:function(e){for(var t=e,a=1;a<r.length;a++)t=t[r[a]];return t},$.each(e,function(e,t){"number"!=typeof n(t)&&(s=!0)}),e.sort(s?function(e,t){return a(n(e),n(t),0)}:function(e,t){return Number(n(t))-Number(n(e))}))},sensorsdata.pagination=function(e){function t(e){if(!e.paginationElement&&!e.tableElement)return sensorsdata.log(sensorsdata.languages.get("没有指定表格元素或者分页元素<!--{en}No table elements or Paging element is specified-->")),!1;this.para=$.extend({clickHandle:function(e){sensorsdata.log(e.index,sensorsdata.languages.get("页<!--{en}Page-->"),e.range)},totalItems:0,pageItems:sensorsdata.CONSTSET.paginationSize,pageIndex:1,numberLabelMaxLength:10,formatTitle:function(e,t){return sensorsdata.util.format(sensorsdata.languages.get("共 #{total} 行，当前展示 #{range_start}-#{range_end} 行<!--{en}A total of #{total} rows, the current display of #{range_start}-#{range_end} rows-->"),{total:e,range_start:t[0],range_end:t[1]})},renderAll:null},e),this.totalPage=0,this.currentIndex=this.para.pageIndex-1,this.showInputModel=!1,this.allTrElement=null,this.tplPagination_=$("#g_pagination_tpl").html(),this.firstInit=!0;var t=null;this.para.paginationElement||(t=this.para.tableElement.find(".table-pagination-out"),t.size()>0?this.para.paginationElement=t:(this.para.paginationElement=$('<div class="table-pagination-out clearfix"></div>'),this.para.tableElement.append(this.para.paginationElement))),this.init()}return e=e||{},t.prototype={constructor:t,init:function(){var e=this.para,t=e.tableElement.is(":visible");t&&e.tableElement.hide(),this.para.renderAll&&(this.allTrElement=this.para.renderAll(),0===this.para.totalItems&&(this.para.totalItems=this.allTrElement.length)),this.totalPage=Math.ceil(e.totalItems/e.pageItems),this.para.totalItems>this.para.pageItems?(this.para.paginationElement.show(),this.drawPagination()):this.para.paginationElement.hide(),this.clickEvents(),this.step(this.currentIndex),t&&e.tableElement.show(),this.firstInit=!1},innerClickHandle:function(e){this.allTrElement.css("display","none"),this.allTrElement.slice(e.range[0]-1,e.range[1]).show()},drawPagination:function(){var e=[],t=null,a=0,n={};if(this.totalPage>=this.para.numberLabelMaxLength)this.showInputModel=!0,n.pageInput={totalPage:this.totalPage,currentPage:this.currentIndex+1};else{for(this.showInputModel=!1,a=0;a<this.totalPage;a++)e.push(a);n={pageIndex:e,pageShowIndex:function(){return this+1}}}t=Mustache.render(this.tplPagination_,n),this.para.paginationElement.html(t)},setIndex:function(e,t){this.currentIndex=e;var a=this.para.formatTitle(this.para.totalItems,t);this.para.paginationElement.find("div.g-pagination-list").html(a),this.showInputModel?this.para.paginationElement.find(".g-pagination-input").val(e+1):(this.para.paginationElement.find("li").removeClass("g-pagination-selected"),this.para.paginationElement.find('li[data-index="'+this.currentIndex+'"]').addClass("g-pagination-selected"))},clickEvents:function(){var e=this;this.para.paginationElement.off("click").on("click",".g-pagination .g-pagination-prev",function(){e.stepPrev()}).on("click",".g-pagination .g-pagination-next",function(){e.stepNext()}),this.showInputModel?(this.para.paginationElement.on("focusout",".g-pagination-input",function(){var t=$(this).val(),a=parseInt(t);/\d+/.test(t)&&a>=1&&a<=e.totalPage?($(this).val(a),e.step(a-1)):$(this).val(e.currentIndex+1)}),this.para.paginationElement.on("keypress",".g-pagination-input",function(e){"Enter"===e.key&&$(this).blur()})):this.para.paginationElement.on("click",".g-pagination .g-pagination-num",function(){e.step($(this).attr("data-index"))})},stepPrev:function(){0!==this.currentIndex&&this.step(this.currentIndex-1)},stepNext:function(){this.currentIndex+1<this.totalPage&&this.step(this.currentIndex+1)},step:function(e){e=Number(e);var t=0,a=[];t=e+1,a[0]=e*this.para.pageItems+1,a[1]=this.para.pageItems*t>this.para.totalItems?this.para.totalItems:t*this.para.pageItems,this.setIndex(e,a),this.para.clickHandle({index:t,range:a}),$.isFunction(this.para.updateHeader)&&!this.firstInit&&this.para.updateHeader(this.para.tableElement),this.para.renderAll&&this.innerClickHandle({index:t,range:a})}},new t(e)},sensorsdata.maskLayer={show:function(){var e=$("<div>");$("body").append(e),e.css({width:"100%",height:"100%",opacity:.7,position:"absolute",background:"#000",left:0,right:0,top:0,zIndex:1030}),this.maskEle=e},hide:function(){this.maskEle.remove()}},function(){function e(e){this.para=e,this.init()}var t=0;e.prototype={bindHide:function(){var e=this;$(document).on("click.floatLayer",function(t){var a=!0;e.para.unCloseClass&&$.each(e.para.unCloseClass,function(e,n){0!==$(t.target).closest("."+n).size()&&(a=!1)}),a&&($(document).off(".floatLayer"),e&&e.hideView())})},showView:function(){$.isFunction(this.para.onLoad)&&this.para.onLoad.call(this),this.bindHide()},hideView:function(){$.isFunction(this.para.onClose)?this.para.onClose.call(this):this.para.floatEle.hide(),$(document).off(".floatLayer")},init:function(){this.para.unCloseClass=this.para.unCloseClass||[],this.para.floatEle&&(this.para.floatEle.addClass("g-floatlayer"),this.para.unCloseClass.push("g-floatlayer")),this.para.clickEleBtn&&(this.para.clickEleBtn.addClass("g-floatlayer-btn"),this.para.unCloseClass.push("g-floatlayer-btn")),this.showView()}},sensorsdata.showFloatLayer=function(a){a=$.extend({serial:++t},a),new e(a)}}(),sensorsdata.floatLayerRight=function(e){this.para=e,this.state=null,this.data=e.data,this.init()},sensorsdata.floatLayerRight.prototype={constructor:sensorsdata.floatLayerRight,init:function(){var e=this,t=this.para.btnCancel||".fu-cface-foot .btn-link";t&&this.para.ele.on("click",t,function(){e.hideView()})},showView:function(){var e=this;sensorsdata.maskLayer.show(),sensorsdata.maskLayer.maskEle.on("click",function(){e.hideView()}),$("html,body").css("overflow","hidden"),this.para.ele.css({width:this.para.width,right:-this.para.width}).show().animate({right:0},300,function(){$("html,body").css("overflow","auto")}),this.state=!0},hideView:function(){$("html,body").css("overflow","hidden"),this.para.ele.animate({right:-this.para.width},function(){$(this).hide(),$("html,body").css("overflow","auto"),sensorsdata.maskLayer.hide()}),this.state=!1}},sensorsdata.findEventCname=function(e,t){var a="";if(e===sensorsdata.CONSTSET.eventEmptyValue)a=sensorsdata.CONSTSET.eventEmptyText;else{$.isArray(t)&&0!==t.length||(t=sensorsdata.cache.events);var n=t.filter(function(t){return t.name===e})[0];n&&(a=n.cname)}return a},sensorsdata.findEventName=function(e,t){var a="";if(e===sensorsdata.CONSTSET.eventEmptyText)a=sensorsdata.CONSTSET.eventEmptyValue;else{$.isArray(t)&&0!==t.length||(t=sensorsdata.cache.events);var n=t.filter(function(t){return t.cname===e})[0];n&&(a=n.name)}return a},sensorsdata.findProperty=function(e,t){if(!e||$.isEmptyObject(t))return{};for(var a=$.isArray(t)?t:[t],n=e.split("."),s=n.length,r=1===n.length?e:n[s-1],o=0,i=a.length;i>o;o++){var l=a[o];if(!$.isEmptyObject(l)){var u=$.isArray(l)?l:l.session||[],d=$.isArray(l)?l:l.event||[],c=$.isArray(l)?l:l.user||[],g={};if((1===s||3===s&&"session"===n[0])&&(g=u.filter(function(e){return e.name===r})[0]||{}),!$.isEmptyObject(g)||1!==s&&3!==s||(g=d.filter(function(e){return e.name===r})[0]||{}),!$.isEmptyObject(g)||1!==s&&2!==s||(g=c.filter(function(e){return e.name===r})[0]||{}),!$.isEmptyObject(g))return g}}return{}},sensorsdata.buildWeekRangeTip=function(e){var t=moment(e,sensorsdata.CONSTSET.timeFormat);if(!t.isValid())return"";var a=t.clone().add(6,"day");a.isAfter(moment())&&(a=moment());var n=sensorsdata.CONSTSET.shortDateFormat,s=sensorsdata.CONSTSET.cnWeekDay;return t.format(n)+"("+s[t.weekday()]+")"+sensorsdata.CONSTSET.dateRangeSplit+a.format(n)+"("+s[a.weekday()]+")"},sensorsdata.localStorage={setItem:function(e,t){try{return window.localStorage.setItem(e,t)}catch(a){console.info(a)}},getItem:function(e){try{return window.localStorage.getItem(e)}catch(t){return console.info(t),null}},removeItem:function(e){try{return window.localStorage.removeItem(e)}catch(t){return console.info(t),null}},getJSON:function(e,t){try{var a=window.localStorage.getItem(e);if(a)return a=JSON.parse(a),a[t]}catch(n){console.info(n)}},setJSON:function(e,t,a){try{var n=window.localStorage.getItem(e);n=n?JSON.parse(n):{},n[t]=a,window.localStorage.setItem(e,JSON.stringify(n))}catch(s){console.info(s)}},removeJSON:function(e,t){try{var a=window.localStorage.getItem(e);a&&(a=JSON.parse(a),delete a[t],window.localStorage.setItem(e,JSON.stringify(a)))}catch(n){console.info(n)}}},sensorsdata.sessionStorage={setItem:function(e,t){try{return window.sessionStorage.setItem(e,t)}catch(a){console.info(a)}},getItem:function(e){try{return window.sessionStorage.getItem(e)}catch(t){return console.info(t),null}},removeItem:function(e){try{return window.sessionStorage.removeItem(e)}catch(t){return console.info(t),null}}},sensorsdata.formatTime=function(e,t,a,n,s){var r=sensorsdata.CONSTSET,o=r.cnWeekDay,i=function(s){if(!moment.isMoment(s)||!s.isValid())return"-";var i="";switch(t){case"minute":i=r.shortTimeFormat,n===!1&&(i="H:mm");break;case"hour":i=r.shortTimeFormat;break;case"day":i=r.shortDateFormat;break;case"week":i=r.shortDateFormat+sensorsdata.languages.get("当周<!--{en}This week-->");break;case"month":i=sensorsdata.languages.get("M月<!--{en}M month-->")}var l=e;return i&&(l=s.format(i),"day"===t&&a!==!1&&(l+="("+o[s.weekday()]+")")),l},l=[];if($.isArray(e))l=e.map(function(e){return moment.isMoment(e)?e:moment(e,sensorsdata.CONSTSET.timeFormat)});else if(moment.isMoment(e))l.push(e);else if(e.indexOf(r.bucketSplit)>0){var u=e.split(r.bucketSplit);l.push(moment(u[0],r.timeFormat)),l.push(moment(u[1],r.timeFormat))}else{var d=moment(e,r.timeFormat);l.push(d)}return 1===l.length?i(l[0]):2===l.length?i(l[0])+(s||"/")+i(l[1]):void 0},sensorsdata.buildTimeRangeText=function(e,t,a){a=a||sensorsdata.getTimeFormat([e,t]);var n=sensorsdata.CONSTSET;return e=moment.isMoment(e)?e:moment(e,n.dateFormat),t=moment.isMoment(t)?t:moment(t,n.dateFormat),e.isSame(t)?e.format(a):e.format(a)+n.dateRangeSplit+t.format(a)},sensorsdata.findIndex=function(e,t){if(!$.isArray(e)||!$.isFunction(t))return-1;for(var a=0,n=e.length;n>a;a++)if(t(e[a],a))return a;return-1},sensorsdata.formatNumber=function(e,t,a){if(null===e)return"--";if(!$.isNumeric(e))return e+"";if(e+="","0"===e)return e+(a?"%":"");if(t!==!0)return(e+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+(a?"%":"");if(-1!==e.indexOf("."))return e;e=parseInt(e,10);var n="";return 0>e&&(n=sensorsdata.languages.get("负<!--{en}negative-->"),e=Math.abs(e)),e%1e8===0?n+e/1e8+sensorsdata.languages.get("亿<!--{en}A hundred million-->"):e%1e4===0?n+e/1e4+sensorsdata.languages.get("万<!--{en}Ten thousand-->"):n+e},sensorsdata.toNumber=function(e){return e?(e=(e+"").replace(/,/g,""),-1===e.indexOf(".")?parseInt(e,10):parseFloat(e,10)):0},sensorsdata.isFloat=function(e){return-1!==e.toString().indexOf(".")},sensorsdata.addNumber=function(e,t){var a,n,s;try{n=e.split(".")[1].length}catch(r){n=0}try{s=t.split(".")[1].length}catch(r){s=0}return a=Math.pow(10,Math.max(n,s)),(e*a+t*a)/a},sensorsdata.isNumeric=function(e){return $.isNumeric(e)?!0:(e=(e+"").replace(/,/g,""),"%"===e[e.length-1]&&(e=e.substring(0,e.length-1)),$.isNumeric(e))},sensorsdata.popover=function(e){if(e=$.extend({template:$("#sensors_popover_box_out").html(),html:!0,content:"",placement:"top",container:"body",showNow:!1,successName:null,successClass:"btn-success",cancelName:null,footer:null,onShow:null,beforeShow:null,success:function(){}},e),null===e.template&&delete e.template,!e.ele||0===e.ele.size()||e.ele.data("bs.popover"))return!1;e.uuid_=sensorsdata.popover.uuid_?++sensorsdata.popover.uuid_:0,e.ele.popover(e);var t=e.ele.data("bs.popover"),a=t.tip();null!==e.footer&&a.find(".popover-content-footer").html(e.footer),e.className&&a.addClass(e.className),a.find(".pop-is-success").on("click",function(){e.successAfter?t.hide(function(){t.options.successAfter.call(t)}):(t.options.success.call(t),t.hide())}),a.find(".pop-is-cancel").off().on("click",function(){t.hide()}),e.ele.on("show.bs.popover",function(){e.beforeShow&&e.beforeShow(a)}).on("shown.bs.popover",function(){var t=$(this).data("bs.popover"),a=t.$tip;e.onShow&&e.onShow(t),$(document).off("click.gpopover"+e.uuid_).on("click.gpopover"+e.uuid_,function(e){0===$(e.target).closest("#"+a.attr("id")).size()&&t.hide()})}).on("hide.bs.popover",function(){$(document).off("click.gpopover"+e.uuid_)}),e.showNow&&e.ele.popover("show")},sensorsdata.convertRelativeTimeLabel=function(e){e=sensorsdata.CONSTSET.abandonedRelativeTime[e]||e;var t=sensorsdata.CONSTSET.relativeTime,a="";for(var n in t)t.hasOwnProperty(n)&&t[n]===e&&(a=n);if(!a&&3===e.split(",").length){var s=e.split(","),r=parseInt(s[0],10),o=parseInt(s[1],10);r>=0&&o>=0&&(a=0===o?sensorsdata.languages.get("最近<!--{en}Lately-->")+(r+1)+sensorsdata.languages.get("天<!--{en}day-->"):1===o?sensorsdata.languages.get("过去<!--{en}In the past-->")+r+sensorsdata.languages.get("天<!--{en}day-->"):sensorsdata.languages.get("过去<!--{en}In the past-->")+o+sensorsdata.languages.get("天 - 过去<!--{en}Day- in the past-->")+r+sensorsdata.languages.get("天<!--{en}day-->"))}return a||e},sensorsdata.convertTimeRange=function(e,t){if(!e)return[];e=sensorsdata.CONSTSET.abandonedRelativeTime[e]||e;var a=[],n=!1,s="day",r=[],o=sensorsdata.CONSTSET.relativeTime;for(var i in o)if(o.hasOwnProperty(i)&&o[i]===e){r=e.split(" ");var l=$.isNumeric(r[0])?parseInt(r[0],10):r[0];if(s=r[1],n=0===l,"last"===l)a.push(sensorsdata.getBeginDate(s).subtract(1,s)),a.push(sensorsdata.getBeginDate(s).subtract(1,"day"));else if(0===l)a.push(sensorsdata.getBeginDate(s)),a.push(moment().startOf("day"));else if(l>0)a.push(moment().startOf("day").subtract(l,s)),a.push(moment().startOf("day").subtract(1,"day"));else if(-1===l){var u=sensorsdata.cache.partitions.length>0?sensorsdata.cache.partitions[0]:"1970-01-01";a.push(moment(u,sensorsdata.CONSTSET.dateFormat)),a.push(moment().startOf("day"))}break}if(0===a.length&&(r=e.split(","),3===r.length&&$.isNumeric(r[0])&&$.isNumeric(r[1]))){var d=parseInt(r[0],10),c=parseInt(r[1],10);a.push(moment().startOf("day").subtract(d,r[2])),a.push(moment().startOf("day").subtract(c,r[2]))}if(t!==!1&&0===a.length){r=e.match(/\d{4}-\d{1,2}-\d{1,2}/g)||[];var g=moment(r[0],sensorsdata.CONSTSET.inputDateFormat),p=moment(r[1],sensorsdata.CONSTSET.inputDateFormat);2===r.length&&moment.isMoment(g)&&moment.isMoment(p)&&(a.push(g),a.push(p))}if(2===a.length){var m=a[1].diff(a[0],"day");a.push(n?a[0].clone().subtract(1,s):a[0].clone().subtract(1+m,s)),a.push(a[2].clone().add(m,"day"))}return a},sensorsdata.buildDefaultTimeRange=function(){return[sensorsdata.getBeginDate("week"),moment().startOf("day")]},sensorsdata.fillBookmarkTime=function(e,t,a,n){if(t){a=a||0,n=n||"day";var s=!1,r=function(e,t){if(0>=a)return t;var r=sensorsdata.getBeginDate(n,e),o=sensorsdata.getBeginDate(n,t),i=o.diff(r,n);if(i>a){s=!0,t=sensorsdata.getEndDate(n,r.clone().add(a,n));var l=moment();t.isAfter(l)&&(t=l.startOf("day"))}return t},o=sensorsdata.CONSTSET.dateFormat,i=sensorsdata.convertTimeRange(t);return i.length>0&&(i[1]=r(i[0],i[1]),e.from_date=i[0].format(o),e.to_date=i[1].format(o),e.compare_from_date&&e.compare_to_date&&(i[3]=r(i[2],i[3]),e.compare_from_date=i[2].format(o),e.compare_to_date=i[3].format(o))),s}},sensorsdata.buildTimeRanges=function(){var e=sensorsdata.getBeginDate("day"),t=e.clone().subtract(1,"days"),a=sensorsdata.CONSTSET.dateFormat,n=sensorsdata.cache.partitions.length>0?sensorsdata.cache.partitions[0]:"1970-01-01";return function(){var s={};return s[sensorsdata.languages.get("昨日<!--{en}Yesterday-->")]=[t.clone(),t.clone()],s[sensorsdata.languages.get("今日<!--{en}Today-->")]=[e.clone(),e.clone()],s[sensorsdata.languages.get("上周<!--{en}Last week-->")]=[sensorsdata.getBeginDate("week").subtract(1,"week"),sensorsdata.getEndDate("week").subtract(1,"week")],s[sensorsdata.languages.get("本周<!--{en}This week-->")]=[sensorsdata.getBeginDate("week"),e.clone()],s[sensorsdata.languages.get("上月<!--{en}Last month-->")]=[e.clone().subtract(1,"month").startOf("month"),e.clone().subtract(1,"month").endOf("month").startOf("day")],s[sensorsdata.languages.get("本月<!--{en}This month-->")]=[sensorsdata.getBeginDate("month"),e.clone()],s[sensorsdata.languages.get("去年<!--{en}Last year-->")]=[e.clone().subtract(1,"year").startOf("year"),e.clone().subtract(1,"year").endOf("year").startOf("day")],s[sensorsdata.languages.get("本年<!--{en}This year-->")]=[sensorsdata.getBeginDate("year"),e.clone()],s[sensorsdata.languages.get("过去 7 天<!--{en}Last 7 days-->")]=[e.clone().subtract(7,"day"),t.clone()],s[sensorsdata.languages.get("过去 30 天<!--{en}Last 30 days-->")]=[e.clone().subtract(30,"day"),t.clone()],s[sensorsdata.languages.get("上线至今<!--{en}So far-->")]=[moment(n,a),e.clone()],s}()},sensorsdata.getRangeText=function(e){var t=[["昨日","Yesterday"],["今日","Today"],["上周","Last week"],["本周","This week"],["上月","Last month"],["本月","This month"],["去年","Last year"],["本年","This year"],["过去 7 天","Last 7 days"],["过去 30 天","Last 30 days"],["过去 90 天","Last 90 days"],["过去 180 天","Last 180 days"],["过去 365 天","Last 365 days"],["上线至今","So far"]],a="";return t.map(function(t){-1!==t.indexOf(e)&&(a="en"===sensorsdata.languages._locale?t[1]:t[0])}),a},sensorsdata.initDateRangeInput=function(e,t){t=$.isEmptyObject(t)?{}:t,$.isEmptyObject(t.ranges)&&(t.ranges=sensorsdata.buildTimeRanges());
var a=t.chosenLabel;a&&(t.chosenLabel=sensorsdata.getRangeText(a)||a);var n="data-calendar-status-refresh-time",s=sensorsdata.CONSTSET,r=function(a){var r=e.data("daterangepicker");!a&&r&&(r.remove(),r=null);var o=$.extend(!0,[],sensorsdata.cache.partitions);if(e.attr(n,moment().unix()),t=r&&a?r.getOptions():t,$.isArray(o)&&o.length>0){var i=moment().startOf("day"),l=moment(o.pop(),s.dateFormat),u=moment(o.shift(),s.dateFormat);t.ranges=sensorsdata.buildTimeRanges(),t.maxDate=l.isAfter(i)?i:l,t.minDate=u.isAfter(i)?i:u,t.dateTemplate=sensorsdata.languages.get("YYYY年M月<!--{en}YYYY/MM-->"),t.separator=sensorsdata.languages.get("至<!--{en} To -->"),t.locale={applyLabel:sensorsdata.languages.get("确定<!--{en}Ok-->"),cancelLabel:sensorsdata.languages.get("取消<!--{en}Cancel-->"),fromLabel:sensorsdata.languages.get("从<!--{en}from-->"),toLabel:sensorsdata.languages.get("到<!--{en}to-->"),weekLabel:sensorsdata.languages.get("周<!--{en}week-->"),customRangeLabel:"",daysOfWeek:[sensorsdata.languages.get("日<!--{en}SUN-->"),sensorsdata.languages.get("一<!--{en}MON-->"),sensorsdata.languages.get("二<!--{en}THU-->"),sensorsdata.languages.get("三<!--{en}WED-->"),sensorsdata.languages.get("四<!--{en}THU-->"),sensorsdata.languages.get("五<!--{en}FRI-->"),sensorsdata.languages.get("六<!--{en}SAT-->")],monthNames:[sensorsdata.languages.get("一月<!--{en}Jan-->"),sensorsdata.languages.get("二月<!--{en}Feb-->"),sensorsdata.languages.get("三月<!--{en}Mar-->"),sensorsdata.languages.get("四月<!--{en}Apr-->"),sensorsdata.languages.get("五月<!--{en}May-->"),sensorsdata.languages.get("六月<!--{en}Jun-->"),sensorsdata.languages.get("七月<!--{en}Jul-->"),sensorsdata.languages.get("八月<!--{en}Aug-->"),sensorsdata.languages.get("九月<!--{en}Sept-->"),sensorsdata.languages.get("十月<!--{en}Oct-->"),sensorsdata.languages.get("十一月<!--{en}Nov-->"),sensorsdata.languages.get("十二月<!--{en}Dec-->")],firstDay:moment.localeData()._week.dow},t.getTplHourSelect=function(){var e=sensorsdata.languages.get("时<!--{en} hours-->");return'<select class="hour"><option value="0">0'+e+'</option><option value="1">1'+e+'</option><option value="2">2'+e+'</option><option value="3">3'+e+'</option><option value="4">4'+e+'</option><option value="5">5'+e+'</option><option value="6">6'+e+'</option><option value="7">7'+e+'</option><option value="8">8'+e+'</option><option value="9">9'+e+'</option><option value="10">10'+e+'</option><option value="11">11'+e+'</option><option value="12">12'+e+'</option><option value="13">13'+e+'</option><option value="14">14'+e+'</option><option value="15">15'+e+'</option><option value="16">16'+e+'</option><option value="17">17'+e+'</option><option value="18">18'+e+'</option><option value="19">19'+e+'</option><option value="20">20'+e+'</option><option value="21">21'+e+'</option><option value="22">22'+e+'</option><option value="23">23'+e+"</option></select>"},t.getDRPTemplate=function(e){return sensorsdata.languages.replace('<div class="daterangepicker dropdown-menu '+(t.className?t.className:"")+'"><div class="title"  style="display: none;"><div data-method="relative-time" data-relative="dynamic" class="dynamic">动态时间<!--{en}Dynamic time--></div><div data-method="relative-time" data-relative="static" class="static selected">静态时间<!--{en}Static time--></div><div class="real-time"></div></div><div class="title original-title"><div>时间范围</div><div>起始时间</div><div>终止时间</div></div><div class="calendar-wrap"><div class="calendar first left"></div><div class="calendar second right"></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input"><label for="daterangepicker_start"></label><input class="input-mini" type="text" name="daterangepicker_start" value="" /></div><div class="daterangepicker_end_input"><label for="daterangepicker_end"></label><input class="input-mini" type="text" name="daterangepicker_end" value="" /></div><button class="applyBtn" disabled="disabled"></button>&nbsp;<button class="cancelBtn"></button></div></div></div><div class="toolbar"><span class="item time-extend"><label class="sa-checkbox"><input id="'+e+'-time-extend" type="checkbox"><label for="'+e+'-time-extend"></label><span></span></label>&nbsp;<span class="icon-help"></span></span><span class="item compare"><label class="sa-checkbox"><input id="'+e+'1" type="checkbox"><label for="'+e+'1"></label>对比日期<!--{en}Contrast date--></label><span style="display:none;"><div class="dropdown"><button type="button" class="btn btn-default dropdown-toggle btn-small" data-toggle="dropdown" aria-expanded="false"><span class="selected" data-value="last period">上一时段</span><span class="caret"></span></button><ul class="dropdown-menu pull-right sa-small" role="menu"><li><a data-value="last period">上一时段</a></li><li><a data-value="last year">去年同期</a></li><li style="display:none;"><a data-value="custom">自定义</a></li></ul></div><input type="text" class="sa-small"/>&nbsp;-&nbsp;<input type="text" class="sa-small"/></span></span><span class="item"><button class="cancelBtn btn btn-link btn-small"></button>&nbsp;<button class="applyBtn btn btn-primary btn-small" disabled="disabled"></button></span></div></div>')}}r&&a?r.setOptions(t):e.daterangepicker(t)};r(),e.bind("mouseover.basepage",function(){var t=parseInt(e.attr(n)||0,60);(0===t||moment().unix()-t>10)&&r(!0)})},sensorsdata.checkCrossTime=function(e){var t={yearCross:!1,timeCross:!1,timeEmpty:!0},a=[];if($.isArray(e)&&0!==e.length?a=e:arguments.length>1&&(a=arguments),a.length<=1)return t;for(var n=moment.isMoment(a[0])?a[0]:moment(a[0],sensorsdata.CONSTSET.timeFormat),s=n.year(),r=n.format("HH:mm:ss"),o=1,i=a.length;i>o;o++)(a[o]||moment.isMoment(r[o]))&&(n=moment.isMoment(a[o])?a[o]:moment(a[o],sensorsdata.CONSTSET.timeFormat),s!==n.year()&&(t.yearCross=!0),r!==n.format("HH:mm:ss")&&(t.timeCross=!0),"00:00:00"!==n.format("HH:mm:ss")&&(t.timeEmpty=!1));return t},sensorsdata.getBeginDate=function(e,t,a){var n=moment();if(t&&(n=moment.isMoment(t)?t.clone():moment(t,a||sensorsdata.CONSTSET.timeFormat)),"week"===e){n.startOf("day");var s=n.weekday();return n.subtract(0===s?6:s-1,"day")}return n.startOf(e)},sensorsdata.getEndDate=function(e,t){var a=moment();if(t&&(a=moment.isMoment(t)?t:moment(t,sensorsdata.CONSTSET.timeFormat)),"week"===e){a.startOf("day");var n=a.weekday();return 0===n?a:a.add(7-n,"day")}return a.endOf(e).startOf("hour"===e?"hour":"day")},sensorsdata.formatTimeBucketValue=function(e,t,a){var n=sensorsdata.CONSTSET,s=n.bucketSplit;if(!e||-1===e.indexOf(s))return e;a||(a="datetime"===t?n.timeFormat:n.inputDateFormat);var r=e.split(s),o=moment(r[0],n.timeFormat).format(a),i=moment(r[1],n.timeFormat).format(a);return o+n.dateRangeSplit+i},sensorsdata.trimConstHtml=function(e){var t=sensorsdata.CONSTSET;return(e+"").indexOf(t.unknownByValue)>=0&&(e=e.split(t.unknownByValue).join(t.unknownByValueText)),(e+"").indexOf(t.emptyStringByValue)>=0&&(e=e.split(t.emptyStringByValue).join(t.emptyStringByValueText)),e},sensorsdata.formatByValue=function(e,t,a,n,s){var r=sensorsdata.CONSTSET,o=a||r.unknownByValue,i=s||a||r.emptyStringByValue;if(null===e||void 0===e)return o;if(t){if("date"===t||"datetime"===t){var l=e.split(r.bucketSplit),u="date"===t?r.dateFormat:r.timeFormat;if($.isArray(n)&&$.isNumeric(n[0])){var d=parseInt(n[0],10);if(n.length>1){var c="";switch(d){case 0:c=sensorsdata.util.format(sensorsdata.languages.get("每天 #{value} 时<!--{en}Every day #{value} hour-->"),{value:l[0]});break;case 1:c=sensorsdata.util.format(sensorsdata.languages.get("每月 #{value} 日<!--{en}Every month #{value} day-->"),{value:l[0]});break;case 3:c=sensorsdata.util.format(sensorsdata.languages.get("每年 #{value} 月<!--{en}Every year #{value} month-->"),{value:l[0]});break;case 4:c=sensorsdata.util.format(sensorsdata.languages.get("每小时 #{value} 分<!--{en}Every hour #{value} minute-->"),{value:l[0]})}return c}switch(d){case 0:u="YYYY-MM-DD HH:00";break;case 1:u="YYYY-MM-DD";break;case 2:u=sensorsdata.languages.get("YYYY-MM-DD当周<!--{en}YYYY-MM-DD this week-->");break;case 3:u=sensorsdata.languages.get("YYYY-MM月<!--{en}YYYY-MM month-->");break;case 4:u="YYYY-MM-DD HH:mm";break;case 5:u=sensorsdata.languages.get("YYYY年<!--{en}YYYY year-->");break;case 6:u=sensorsdata.languages.get("YYYY年<!--{en}YYYY year-->")}var g=moment(l[0]);return g.isValid()?6===d?g.format(u)+g.quarter()+sensorsdata.languages.get("季度<!--{en}Quarter-->"):g.format(u):"-"}return l.length>1?l.join(r.dateRangeSplit):e?moment(e).format(u):e}if("number"===t){var p=e+"";if(-1!==p.indexOf(r.bucketSplit)){var m=p.split(r.bucketSplit);return"-INF"===m[0]?m[1]+sensorsdata.languages.get("以下<!--{en}Under-->"):"INF"===m[1]?m[0]+sensorsdata.languages.get("以上<!--{en}Above-->"):m[0]+r.dateRangeSplit+m[1]}}else{if("bool"===t)return sensorsdata.languages.get(e?"真<!--{en}True-->":"假<!--{en}False-->");if("string"===t&&""===$.trim(e))return i;if("list"===t)return e?$.isArray(e)?e.join(","):e:i}}return"string"===t&&(e=$.trim(e)),e},sensorsdata.getTimeFormat=function(e,t){var a=sensorsdata.CONSTSET,n=[];e.map(function(e){moment.isMoment(e)?n.push(e):e&&(n=n.concat(e.split(a.bucketSplit)))});var s=sensorsdata.checkCrossTime(n);return s.timeEmpty&&"hour"!==t?s.yearCross?a.inputDateFormat:a.shortDateFormat:s.yearCross?a.timeFormat:a.shortTimeFormat},sensorsdata.getLocationSearch=function(e){e=e||window.location.href;var t={};if(-1===e.indexOf("?"))return t;var a=/\?([^#]+)#?/,n=a.exec(e);if(!$.isArray(n)||n.length<2)return t;var s=n[1],r=s.split("&");return r.map(function(e){if(e){var a=e.split("=");2===a.length&&(t[a[0]]=decodeURIComponent(a[1]))}}),t},sensorsdata.buildBucketPopoverValue=function(e){return $.isArray(e)?1!==e.length||$.isNumeric(e[0])?e.filter(function(e){return $.isNumeric(e)}).map(function(e){return e-0}):[null]:[]},sensorsdata.setModuleByTheme=function(e){if(!$.isEmptyObject(sensorsdata.theme.moduleSetting)){var t=(sensorsdata.theme.moduleSetting[location.pathname]||{}).hiddenSelectors;if($.isArray(t)&&0!==t.length)for(var a=0,n=t.length;n>a;a++)e.find(t[a]).hide()}},sensorsdata.getRandomCharacter=function(e){for(var t=function(e,t){for(var a=[],n=e.charCodeAt(0),s=0;t>s;s++)a.push(String.fromCharCode(s+n));return a},a=t("A",26).concat(t("a",26)).concat(t("0",10)),n=[],s=0;e>s;s++)n.push(a[Math.floor(Math.random()*a.length)]);return n},sensorsdata.FilterGroupEventList=function(e){this.type=e.type||null,this.$container=e.container,this.dataEvents=e.events,this.disabled=e.disabled,this.tpl=e.tpl,this.filters=[]},sensorsdata.FilterGroupEventList.prototype={getProperties:function(e,t){var a="event/properties?events="+e.join(",");e.length>1&&(a+="&method=original"),sensorsdata.ajax({useCache:!0,url:a,success:function(e){t(e)}})},addFilterEvent:function(e,t,a){e=e||{};var n=$(this.tpl);this.$container.append(n),"boolean"==typeof this.disabled&&n.find("button,input").prop("disabled",this.disabled),"funnel"===this.type&&(e.custom_name?(n.find(".funnel-filter-group-input-custom-name").css({display:"inline-block"}).val(e.custom_name),n.find(".funnel-filter-group-input-custom-name-btn").hide()):(n.find(".funnel-filter-group-input-custom-name").val(e.custom_name).hide(),n.find(".funnel-filter-group-input-custom-name-btn").css({display:"inline-block"})));var s=e.event_name||this.dataEvents[0]&&this.dataEvents[0].name;n.data("filterObj",new sensorsdata.FilterGroupControl),n.data("filterObj").events_filter_group_name=s;var r=function(e,t,a){var n={container:e.find(".events-manage-filter-group-content"),disableRelation:"funnel"!==i.type,propertyObj:$.extend(!0,{},t)};n.propertyObj.user=[],"boolean"==typeof i.disabled&&(n.disabled=i.disabled),"funnel"===i.type&&(n.propertyObj.event=n.propertyObj.event.filter(function(e){return"$user_id"!==e.name})),e.data("filterObj").init(n),a&&e.data("filterObj").val(a)},o=function(e,t,a){if("funnel"===i.type){var n={propertyObj:{event:[]}},s={label:"",items:t.event};s.items=s.items.filter(function(e){return"$user_id"!==e.name}).map(function(e){return e.fullName="event."+e.event_name+"."+e.name,e}),s.items.unshift({cname:sensorsdata.languages.get("无<!--{en}None-->"),fullName:"none"}),n.propertyObj.event.push(s),e.find(".events-manage-prop-relation-content").hide().html(Mustache.render($("#tpl-props-relation").html())),e.find('[data-id="relation-props-select"] select').html(Mustache.render($("#tpl-filter-condition-item-property").html(),n.propertyObj.event));var r=e.find('[data-id="relation-props-select"] > select');r.multiselect("select").multiselect({includeFilterClearBtn:!1,enableFiltering:!0}),r.multiselect("select",a)}},i=this;n.find(".selector-event").eventDropdown({eventName:s,events:this.dataEvents,virtualDisplay:!1,onChange:function(e){n.data("filterObj").events_filter_group_name=e;var t=n.find(".events-manage-prop-relation-content").is(":visible");i.getProperties([e],function(a){r(n,a[e]),o(n,a[e]),i.toggleRelationField(t)})}}),$.isEmptyObject(t)?i.getProperties([s],function(t){r(n,t[s]),o(n,t[s],e.relevance_field),i.toggleRelationField(a)}):(r(n,t,e.filter),o(n,t,e.relevance_field),i.toggleRelationField(a)),n.on("click",".events-manage-filter-group-add-filter",function(){n.data("filterObj").addFilter()}),n.on("click",".events-manage-filter-event-remove",function(){n.remove()})},getData:function(){var e=[];return this.$container.find(".events-manage-filter-group").each(function(t,a){var n={};if(n.event_name=$(a).data("filterObj").events_filter_group_name,n.filter=$(a).data("filterObj").val(),n.custom_name=$(a).find(".funnel-filter-group-input-custom-name").val(),$(a).find(".events-manage-prop-relation-content").is(":visible")){var s=$(a).find('[data-id="relation-props-select"] > select'),r=s.find(":selected");"none"!==r.val()&&(n.relevance_field=r.val())}e.push(n)}),e},setData:function(e,t){if($.isArray(e)&&0!==e.length){var a=this,n=e.map(function(e){return e.event_name});this.$container.html($("#tpl-widget-loader").html()),this.getProperties(n,function(n){a.$container.html("");for(var s=0,r=e.length;r>s;s++)a.addFilterEvent(e[s],$.extend(!0,{},n[e[s].event_name]));$.isFunction(t)&&t()})}},toggleRelationField:function(e){"funnel"===this.type&&("undefined"==typeof e?this.$container.find(".events-manage-prop-relation-content").toggle():this.$container.find(".events-manage-prop-relation-content").toggle(!!e))}},sensorsdata.form={addError:function(e,t,a,n){if(!e.hasClass("error")){var s={animation:!1,container:"body",title:t,placement:"right",template:$("#tpl-form-error-tooltip").html()};s=$.extend(!0,s,n),e.addClass("error"),e.tooltip("destroy"),t&&(e.tooltip(s),!0===a&&e.tooltip("show"))}},removeError:function(e){e.hasClass("error")&&e.removeClass("error").tooltip("hide").tooltip("destroy").removeAttr("data-original-title")},removeChildrenError:function(e){e.find(".error").each(function(){sensorsdata.form.removeError($(this))})},checkChildren:function(e,t,a,n){return sensorsdata.form.check(e.find("[data-error-reg-exp]"),t,a,n)},check:function(e,t,a,n){var s=$.isArray(e)?e:[e];a=a>0?a:1;for(var r=!0,o=0,i=0,l=s.length;l>i;i++)for(var u=0,d=s[i].size();d>u;u++){var c=s[i].eq(u),g=c.attr("data-error-reg-exp");if(g&&c.is(":visible")){var p=c.attr("data-error-text"),m=RegExp(g,"g"),h=$.trim(c.val()),f=m.test(h);f!==!0?(o++,sensorsdata.form.addError(c,p,a>=o,n)):sensorsdata.form.removeError(c),r=r&&f}}return r},addErrorCheck:function(e){for(var t=function(){sensorsdata.form.check($(this))},a=$.isArray(e)?e:[e],n=0,s=a.length;s>n;n++)a[n].unbind("focusout.sa-error-check").bind("focusout.sa-error-check",t)},addTooltip:function(e,t,a){if(!e.hasClass("error")){t=t||e.attr("data-original-title");var n={animation:!1,container:"body",title:t,placement:"top",autoShow:!1};n=$.extend(!0,n,a),e.attr("data-original-title",t),e.tooltip("destroy"),t&&(e.tooltip(n),!0===n.autoShow&&e.tooltip("show"))}}},sensorsdata.table2csv=function(e,t,a){var n=[],s=[];e.heads.forEach(function(e){var t=sensorsdata.util.encodeCsvItem(sensorsdata.trimConstHtml(e.originalTime||e.value).replace(/<\/br\s*\/?>/g,"/"));s.push(t)});var r=[];e.rows.forEach(function(e){var t=[];a?e.forEach(function(e){var a=sensorsdata.util.encodeCsvItem(sensorsdata.trimConstHtml((e.originalTime||e.value)+"").replace(/<\/br\s*\/?>/g,"/"));t.push(a)}):(r=r.map(function(e){if(e.count>0){var a=sensorsdata.util.encodeCsvItem(sensorsdata.trimConstHtml(e.value+"").replace(/<\/br\s*\/?>/g,"/"));t.push(a),e.count--}return e}),e.forEach(function(e){var a=sensorsdata.util.encodeCsvItem(sensorsdata.trimConstHtml((e.originalTime||e.value)+"").replace(/<\/br\s*\/?>/g,"/"));e.rowSpan&&r.push({count:e.rowSpan-1,value:a}),t.push(a)})),t=t.join(","),n.push(t)}),s=s.join(","),n=n.join("\n");var o="﻿"+s+"\n"+n;saveTextAs(o,t+".csv")},sensorsdata.convertTimeText=function(e){var t=function(){var e={},t=sensorsdata.getBeginDate("day"),a=t.clone().subtract(1,"days"),n=sensorsdata.CONSTSET.dateFormat,s=sensorsdata.cache.partitions.length>0?sensorsdata.cache.partitions[0]:"1970-01-01";return e["昨日"]=[a.clone(),a.clone()],e["今日"]=[t.clone(),t.clone()],e["上周"]=[sensorsdata.getBeginDate("week").subtract(1,"week"),sensorsdata.getEndDate("week").subtract(1,"week")],e["本周"]=[sensorsdata.getBeginDate("week"),t.clone()],e["上月"]=[t.clone().subtract(1,"month").startOf("month"),t.clone().subtract(1,"month").endOf("month").startOf("day")],e["本月"]=[sensorsdata.getBeginDate("month"),t.clone()],e["去年"]=[t.clone().subtract(1,"year").startOf("year"),t.clone().subtract(1,"year").endOf("year").startOf("day")],e["本年"]=[sensorsdata.getBeginDate("year"),t.clone()],e["过去7天"]=[t.clone().subtract(7,"day"),a.clone()],e["过去30天"]=[t.clone().subtract(30,"day"),a.clone()],e["上线至今"]=[moment(s,n),t.clone()],e.Yesterday=[a.clone(),a.clone()],e.Today=[t.clone(),t.clone()],e.Lastweek=[sensorsdata.getBeginDate("week").subtract(1,"week"),sensorsdata.getEndDate("week").subtract(1,"week")],e.Thisweek=[sensorsdata.getBeginDate("week"),t.clone()],e.Lastmonth=[t.clone().subtract(1,"month").startOf("month"),t.clone().subtract(1,"month").endOf("month").startOf("day")],e.Thismonth=[sensorsdata.getBeginDate("month"),t.clone()],e.Lastyear=[t.clone().subtract(1,"year").startOf("year"),t.clone().subtract(1,"year").endOf("year").startOf("day")],e.Thisyear=[sensorsdata.getBeginDate("year"),t.clone()],e.Last7days=[t.clone().subtract(7,"day"),a.clone()],e.Last30days=[t.clone().subtract(30,"day"),a.clone()],e.Sofar=[moment(s,n),t.clone()],e}(),a=e.split(" ").join(""),n=sensorsdata.getBeginDate("day"),s=n.clone().subtract(1,"days");if(t[a])return t[a];var r=/(^过去\s*(\d+)\s*天\s*-\s*过去\s*(\d+)\s*天$)|(^Inthepast\s*(\d+)\s*Day\s*-\s*inthepast\s*(\d+)\s*day$)/,o=/(^过去\s*(\d+)\s*天$)|(^Inthepast\s*(\d+)\s*day$)/,i=/(^最近\s*(\d+)\s*天$)|(^Lately\s*(\d+)\s*day$)/,l=0;if(r.test(a)){var u=a.match(r),d=Number(u[3]||u[6]),c=Number(u[2]||u[5]);return[n.clone().subtract(d,"day"),n.clone().subtract(c,"day")]}return o.test(a)?(l=Number(a.match(o)[2]||a.match(o)[4]),[n.clone().subtract(l,"day"),s.clone()]):i.test(a)?(l=Number(a.match(i)[2]||a.match(i)[4]),[n.clone().subtract(l-1,"day"),n.clone()]):void 0};